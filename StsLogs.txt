2019-02-19 09:39:18.351 +01:00 [INF] User profile is available. Using 'C:\Users\stduser\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2019-02-19 09:39:18.812 +01:00 [INF] Starting IdentityServer4 version 2.3.2.0
2019-02-19 09:39:18.837 +01:00 [INF] You are using the in-memory version of the persisted grant store. This will store consent decisions, authorization codes, refresh and reference tokens in memory only. If you are using any of those features in production, you want to switch to a different store implementation.
2019-02-19 09:39:18.868 +01:00 [INF] Using the default authentication scheme Identity.Application for IdentityServer
2019-02-19 09:39:21.861 +01:00 [INF] Request starting HTTP/1.1 GET http://localhost:44352/  
2019-02-19 09:39:21.861 +01:00 [INF] Request starting HTTP/1.1 DEBUG http://localhost:44352/  0
2019-02-19 09:39:21.896 +01:00 [INF] Request finished in 35.999ms 200 
2019-02-19 09:39:22.899 +01:00 [INF] Request starting HTTP/1.1 GET http://localhost:44352/.well-known/openid-configuration  
2019-02-19 09:39:23.429 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-02-19 09:39:23.538 +01:00 [INF] Executing endpoint 'StsServerIdentity.Controllers.HomeController.Index (StsServerIdentity)'
2019-02-19 09:39:23.589 +01:00 [INF] Route matched with {action = "Index", controller = "Home"}. Executing action StsServerIdentity.Controllers.HomeController.Index (StsServerIdentity)
2019-02-19 09:39:23.757 +01:00 [INF] Executing action method StsServerIdentity.Controllers.HomeController.Index (StsServerIdentity) - Validation state: "Valid"
2019-02-19 09:39:23.779 +01:00 [INF] Executed action method StsServerIdentity.Controllers.HomeController.Index (StsServerIdentity), returned result Microsoft.AspNetCore.Mvc.ViewResult in 2.2671ms.
2019-02-19 09:39:23.790 +01:00 [INF] Request finished in 890.9964ms 200 application/json; charset=UTF-8
2019-02-19 09:39:23.853 +01:00 [INF] Executing ViewResult, running view Index.
2019-02-19 09:39:23.859 +01:00 [INF] Request starting HTTP/1.1 GET http://localhost:44352/.well-known/openid-configuration/jwks  
2019-02-19 09:39:23.863 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2019-02-19 09:39:23.978 +01:00 [INF] Request finished in 118.6627ms 200 application/jwk-set+json; charset=UTF-8
2019-02-19 09:39:24.177 +01:00 [INF] Request starting HTTP/1.1 POST http://localhost:44352/connect/token application/x-www-form-urlencoded 72
2019-02-19 09:39:24.609 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.TokenEndpoint for /connect/token
2019-02-19 09:39:25.081 +01:00 [INF] Executed ViewResult - view Index executed in 1280.0008ms.
2019-02-19 09:39:25.083 +01:00 [INF] Executed action StsServerIdentity.Controllers.HomeController.Index (StsServerIdentity) in 1492.3619ms
2019-02-19 09:39:25.083 +01:00 [INF] Executed endpoint 'StsServerIdentity.Controllers.HomeController.Index (StsServerIdentity)'
2019-02-19 09:39:25.090 +01:00 [INF] Request finished in 3233.0815ms 200 text/html; charset=utf-8
2019-02-19 09:39:25.136 +01:00 [INF] Request starting HTTP/1.1 GET http://localhost:44352/css/vendor.min.css?v=RtIwopEx0osLqdXB1F1QPDFWzutpmmdukcoICaRWUFI  
2019-02-19 09:39:25.143 +01:00 [INF] Request starting HTTP/1.1 GET http://localhost:44352/js/vendor.min.js?v=yg3700ylkpEbw8o9sR1SsYLHNI0v7pw6lI42YH1q40o  
2019-02-19 09:39:25.147 +01:00 [INF] Request starting HTTP/1.1 GET http://localhost:44352/js/site.min.js?v=47DEQpj8HBSa-_TImW-5JCeuQeRkm5NMpJWZG3hSuFU  
2019-02-19 09:39:25.143 +01:00 [INF] Request starting HTTP/1.1 GET http://localhost:44352/css/site.min.css?v=9n42HB2zuqXKDsr8sMaXB5eFvO87SuAf1CjiV4cv1Fg  
2019-02-19 09:39:25.182 +01:00 [INF] Sending file. Request path: '/js/site.min.js'. Physical path: 'C:\git\damienbod\AspNetCoreHybridFlowWithApi\StsServer\wwwroot\js\site.min.js'
2019-02-19 09:39:25.182 +01:00 [INF] Request finished in 34.9507ms 200 application/javascript
2019-02-19 09:39:25.202 +01:00 [INF] Sending file. Request path: '/css/site.min.css'. Physical path: 'C:\git\damienbod\AspNetCoreHybridFlowWithApi\StsServer\wwwroot\css\site.min.css'
2019-02-19 09:39:25.218 +01:00 [INF] Sending file. Request path: '/css/vendor.min.css'. Physical path: 'C:\git\damienbod\AspNetCoreHybridFlowWithApi\StsServer\wwwroot\css\vendor.min.css'
2019-02-19 09:39:25.230 +01:00 [INF] Sending file. Request path: '/js/vendor.min.js'. Physical path: 'C:\git\damienbod\AspNetCoreHybridFlowWithApi\StsServer\wwwroot\js\vendor.min.js'
2019-02-19 09:39:25.245 +01:00 [INF] Request finished in 102.4523ms 200 text/css
2019-02-19 09:39:25.245 +01:00 [INF] Request finished in 102.4523ms 200 application/javascript
2019-02-19 09:39:25.245 +01:00 [INF] Request finished in 108.8314ms 200 text/css
2019-02-19 09:39:25.282 +01:00 [INF] Token request validation success
{"ClientId":"ProtectedApi","ClientName":"ProtectedApi","GrantType":"client_credentials","Scopes":"scope_used_for_api_in_protected_zone","AuthorizationCode":null,"RefreshToken":null,"UserName":null,"AuthenticationContextReferenceClasses":null,"Tenant":null,"IdP":null,"Raw":{"grant_type":"client_credentials","scope":"scope_used_for_api_in_protected_zone"},"$type":"TokenRequestValidationLog"}
2019-02-19 09:39:25.559 +01:00 [INF] Request finished in 1382.2466ms 200 application/json; charset=UTF-8
2019-02-19 09:39:25.661 +01:00 [INF] Request starting HTTP/1.1 GET http://localhost:44352/.well-known/openid-configuration  
2019-02-19 09:39:25.661 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-02-19 09:39:25.662 +01:00 [INF] Request finished in 1.374ms 200 application/json; charset=UTF-8
2019-02-19 09:39:25.716 +01:00 [INF] Request starting HTTP/1.1 GET http://localhost:44352/.well-known/openid-configuration/jwks  
2019-02-19 09:39:25.717 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2019-02-19 09:39:25.718 +01:00 [INF] Request finished in 2.0135ms 200 application/jwk-set+json; charset=UTF-8
2019-02-19 09:39:25.921 +01:00 [INF] Request starting HTTP/1.1 POST http://localhost:44352/connect/deviceauthorization application/x-www-form-urlencoded 29
2019-02-19 09:39:25.925 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DeviceAuthorizationEndpoint for /connect/deviceauthorization
2019-02-19 09:39:25.984 +01:00 [INF] Request finished in 62.4901ms 200 application/json; charset=UTF-8
2019-02-19 09:39:26.013 +01:00 [INF] Request starting HTTP/1.1 GET http://localhost:44352/.well-known/openid-configuration  
2019-02-19 09:39:26.014 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-02-19 09:39:26.014 +01:00 [INF] Request finished in 1.1122ms 200 application/json; charset=UTF-8
2019-02-19 09:39:26.217 +01:00 [INF] Request starting HTTP/1.1 GET http://localhost:44352/.well-known/openid-configuration/jwks  
2019-02-19 09:39:26.218 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2019-02-19 09:39:26.219 +01:00 [INF] Request finished in 1.375ms 200 application/jwk-set+json; charset=UTF-8
2019-02-19 09:40:04.282 +01:00 [INF] Request starting HTTP/1.1 GET http://localhost:44352/.well-known/openid-configuration  
2019-02-19 09:40:04.282 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-02-19 09:40:04.283 +01:00 [INF] Request finished in 0.8387ms 200 application/json; charset=UTF-8
2019-02-19 09:40:04.300 +01:00 [INF] Request starting HTTP/1.1 GET http://localhost:44352/.well-known/openid-configuration/jwks  
2019-02-19 09:40:04.301 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2019-02-19 09:40:04.301 +01:00 [INF] Request finished in 1.1447ms 200 application/jwk-set+json; charset=UTF-8
2019-02-19 09:40:04.316 +01:00 [INF] Request starting HTTP/1.1 POST http://localhost:44352/connect/deviceauthorization application/x-www-form-urlencoded 29
2019-02-19 09:40:04.317 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DeviceAuthorizationEndpoint for /connect/deviceauthorization
2019-02-19 09:40:04.318 +01:00 [INF] Request finished in 1.4516ms 200 application/json; charset=UTF-8
2019-02-19 09:40:45.655 +01:00 [INF] Request starting HTTP/1.1 GET http://localhost:44352/.well-known/openid-configuration  
2019-02-19 09:40:45.673 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-02-19 09:40:45.673 +01:00 [INF] Request finished in 18.8712ms 200 application/json; charset=UTF-8
2019-02-19 09:40:45.724 +01:00 [INF] Request starting HTTP/1.1 GET http://localhost:44352/.well-known/openid-configuration/jwks  
2019-02-19 09:40:45.727 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2019-02-19 09:40:45.732 +01:00 [INF] Request finished in 8.4732ms 200 application/jwk-set+json; charset=UTF-8
2019-02-19 09:40:45.771 +01:00 [INF] Request starting HTTP/1.1 POST http://localhost:44352/connect/deviceauthorization application/x-www-form-urlencoded 29
2019-02-19 09:40:45.771 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DeviceAuthorizationEndpoint for /connect/deviceauthorization
2019-02-19 09:40:45.772 +01:00 [INF] Request finished in 1.2833ms 200 application/json; charset=UTF-8
2019-02-19 09:41:05.214 +01:00 [INF] Request starting HTTP/1.1 GET http://localhost:44352/.well-known/openid-configuration  
2019-02-19 09:41:05.215 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-02-19 09:41:05.215 +01:00 [INF] Request finished in 1.2402ms 200 application/json; charset=UTF-8
2019-02-19 09:41:05.241 +01:00 [INF] Request starting HTTP/1.1 GET http://localhost:44352/.well-known/openid-configuration/jwks  
2019-02-19 09:41:05.241 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2019-02-19 09:41:05.242 +01:00 [INF] Request finished in 0.7878ms 200 application/jwk-set+json; charset=UTF-8
2019-02-19 09:41:05.250 +01:00 [INF] Request starting HTTP/1.1 POST http://localhost:44352/connect/deviceauthorization application/x-www-form-urlencoded 29
2019-02-19 09:41:05.250 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DeviceAuthorizationEndpoint for /connect/deviceauthorization
2019-02-19 09:41:05.251 +01:00 [INF] Request finished in 0.8799ms 200 application/json; charset=UTF-8
2019-02-19 09:41:09.960 +01:00 [INF] Request starting HTTP/1.1 GET http://localhost:44352/.well-known/openid-configuration  
2019-02-19 09:41:09.961 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-02-19 09:41:09.961 +01:00 [INF] Request finished in 1.0298ms 200 application/json; charset=UTF-8
2019-02-19 09:41:09.964 +01:00 [INF] Request starting HTTP/1.1 GET http://localhost:44352/.well-known/openid-configuration/jwks  
2019-02-19 09:41:09.964 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2019-02-19 09:41:09.965 +01:00 [INF] Request finished in 0.9643ms 200 application/jwk-set+json; charset=UTF-8
2019-02-19 09:41:09.973 +01:00 [INF] Request starting HTTP/1.1 POST http://localhost:44352/connect/deviceauthorization application/x-www-form-urlencoded 29
2019-02-19 09:41:09.973 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DeviceAuthorizationEndpoint for /connect/deviceauthorization
2019-02-19 09:41:09.974 +01:00 [INF] Request finished in 0.879ms 200 application/json; charset=UTF-8
2019-02-19 09:41:12.755 +01:00 [INF] Request starting HTTP/1.1 GET http://localhost:44352/.well-known/openid-configuration  
2019-02-19 09:41:12.756 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-02-19 09:41:12.756 +01:00 [INF] Request finished in 1.0031ms 200 application/json; charset=UTF-8
2019-02-19 09:41:12.759 +01:00 [INF] Request starting HTTP/1.1 GET http://localhost:44352/.well-known/openid-configuration/jwks  
2019-02-19 09:41:12.759 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2019-02-19 09:41:12.759 +01:00 [INF] Request finished in 0.8509ms 200 application/jwk-set+json; charset=UTF-8
2019-02-19 09:41:12.769 +01:00 [INF] Request starting HTTP/1.1 POST http://localhost:44352/connect/deviceauthorization application/x-www-form-urlencoded 29
2019-02-19 09:41:12.769 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DeviceAuthorizationEndpoint for /connect/deviceauthorization
2019-02-19 09:41:12.770 +01:00 [INF] Request finished in 0.8213ms 200 application/json; charset=UTF-8
2019-02-19 11:15:46.372 +01:00 [INF] User profile is available. Using 'C:\Users\stduser\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2019-02-19 11:15:46.791 +01:00 [INF] Starting IdentityServer4 version 2.3.2.0
2019-02-19 11:15:46.821 +01:00 [INF] You are using the in-memory version of the persisted grant store. This will store consent decisions, authorization codes, refresh and reference tokens in memory only. If you are using any of those features in production, you want to switch to a different store implementation.
2019-02-19 11:15:46.841 +01:00 [INF] Using the default authentication scheme Identity.Application for IdentityServer
2019-02-19 11:15:50.397 +01:00 [INF] Request starting HTTP/1.1 GET http://localhost:44352/  
2019-02-19 11:15:50.397 +01:00 [INF] Request starting HTTP/1.1 DEBUG http://localhost:44352/  0
2019-02-19 11:15:50.441 +01:00 [INF] Request finished in 44.1628ms 200 
2019-02-19 11:15:51.431 +01:00 [INF] Request starting HTTP/1.1 GET http://localhost:44352/.well-known/openid-configuration  
2019-02-19 11:15:51.525 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-02-19 11:15:51.696 +01:00 [INF] Request finished in 265.0519ms 200 application/json; charset=UTF-8
2019-02-19 11:15:51.737 +01:00 [INF] Request starting HTTP/1.1 GET http://localhost:44352/.well-known/openid-configuration/jwks  
2019-02-19 11:15:51.738 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2019-02-19 11:15:51.830 +01:00 [INF] Request finished in 92.7873ms 200 application/jwk-set+json; charset=UTF-8
2019-02-19 11:15:52.020 +01:00 [INF] Request starting HTTP/1.1 POST http://localhost:44352/connect/token application/x-www-form-urlencoded 72
2019-02-19 11:15:52.034 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.TokenEndpoint for /connect/token
2019-02-19 11:15:52.248 +01:00 [INF] Token request validation success
{"ClientId":"ProtectedApi","ClientName":"ProtectedApi","GrantType":"client_credentials","Scopes":"scope_used_for_api_in_protected_zone","AuthorizationCode":null,"RefreshToken":null,"UserName":null,"AuthenticationContextReferenceClasses":null,"Tenant":null,"IdP":null,"Raw":{"grant_type":"client_credentials","scope":"scope_used_for_api_in_protected_zone"},"$type":"TokenRequestValidationLog"}
2019-02-19 11:15:52.478 +01:00 [INF] Request finished in 457.6855ms 200 application/json; charset=UTF-8
2019-02-19 11:15:52.813 +01:00 [INF] Entity Framework Core 2.2.2-servicing-10034 initialized 'ApplicationDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer' with options: None
2019-02-19 11:15:52.931 +01:00 [INF] Request starting HTTP/1.1 GET http://localhost:44352/.well-known/openid-configuration  
2019-02-19 11:15:52.932 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-02-19 11:15:52.932 +01:00 [INF] Request finished in 1.5355ms 200 application/json; charset=UTF-8
2019-02-19 11:15:53.128 +01:00 [INF] Request starting HTTP/1.1 GET http://localhost:44352/.well-known/openid-configuration/jwks  
2019-02-19 11:15:53.128 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2019-02-19 11:15:53.129 +01:00 [INF] Request finished in 1.3454ms 200 application/jwk-set+json; charset=UTF-8
2019-02-19 11:15:53.971 +01:00 [INF] Executed DbCommand (50ms) [Parameters=[@__get_Item_0='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [e].[Id], [e].[AccessFailedCount], [e].[ConcurrencyStamp], [e].[DataEventRecordsRole], [e].[Email], [e].[EmailConfirmed], [e].[IsAdmin], [e].[LockoutEnabled], [e].[LockoutEnd], [e].[NormalizedEmail], [e].[NormalizedUserName], [e].[PasswordHash], [e].[PhoneNumber], [e].[PhoneNumberConfirmed], [e].[SecuredFilesRole], [e].[SecurityStamp], [e].[TwoFactorEnabled], [e].[UserName]
FROM [AspNetUsers] AS [e]
WHERE [e].[Id] = @__get_Item_0
2019-02-19 11:15:54.246 +01:00 [INF] Executed DbCommand (51ms) [Parameters=[@__user_Id_0='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT [uc].[Id], [uc].[ClaimType], [uc].[ClaimValue], [uc].[UserId]
FROM [AspNetUserClaims] AS [uc]
WHERE [uc].[UserId] = @__user_Id_0
2019-02-19 11:15:54.312 +01:00 [INF] Executed DbCommand (18ms) [Parameters=[@__userId_0='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT [role].[Name]
FROM [AspNetUserRoles] AS [userRole]
INNER JOIN [AspNetRoles] AS [role] ON [userRole].[RoleId] = [role].[Id]
WHERE [userRole].[UserId] = @__userId_0
2019-02-19 11:15:54.357 +01:00 [INF] Executing endpoint 'StsServerIdentity.Controllers.HomeController.Index (StsServerIdentity)'
2019-02-19 11:15:54.372 +01:00 [INF] Route matched with {action = "Index", controller = "Home"}. Executing action StsServerIdentity.Controllers.HomeController.Index (StsServerIdentity)
2019-02-19 11:15:54.465 +01:00 [INF] Executing action method StsServerIdentity.Controllers.HomeController.Index (StsServerIdentity) - Validation state: "Valid"
2019-02-19 11:15:54.469 +01:00 [INF] Executed action method StsServerIdentity.Controllers.HomeController.Index (StsServerIdentity), returned result Microsoft.AspNetCore.Mvc.ViewResult in 0.7389ms.
2019-02-19 11:15:54.492 +01:00 [INF] Executing ViewResult, running view Index.
2019-02-19 11:15:55.089 +01:00 [INF] Executed ViewResult - view Index executed in 608.1912ms.
2019-02-19 11:15:55.091 +01:00 [INF] Executed action StsServerIdentity.Controllers.HomeController.Index (StsServerIdentity) in 718.55040000000008ms
2019-02-19 11:15:55.091 +01:00 [INF] Executed endpoint 'StsServerIdentity.Controllers.HomeController.Index (StsServerIdentity)'
2019-02-19 11:15:55.113 +01:00 [INF] Request starting HTTP/1.1 GET http://localhost:44352/css/vendor.min.css?v=RtIwopEx0osLqdXB1F1QPDFWzutpmmdukcoICaRWUFI  
2019-02-19 11:15:55.115 +01:00 [INF] Request finished in 4721.8813ms 200 text/html; charset=utf-8
2019-02-19 11:15:55.119 +01:00 [INF] Request starting HTTP/1.1 GET http://localhost:44352/css/site.min.css?v=9n42HB2zuqXKDsr8sMaXB5eFvO87SuAf1CjiV4cv1Fg  
2019-02-19 11:15:55.124 +01:00 [INF] Request starting HTTP/1.1 GET http://localhost:44352/js/vendor.min.js?v=yg3700ylkpEbw8o9sR1SsYLHNI0v7pw6lI42YH1q40o  
2019-02-19 11:15:55.126 +01:00 [INF] Request starting HTTP/1.1 GET http://localhost:44352/js/site.min.js?v=47DEQpj8HBSa-_TImW-5JCeuQeRkm5NMpJWZG3hSuFU  
2019-02-19 11:15:55.136 +01:00 [INF] Sending file. Request path: '/js/site.min.js'. Physical path: 'C:\git\damienbod\AspNetCoreHybridFlowWithApi\StsServer\wwwroot\js\site.min.js'
2019-02-19 11:15:55.137 +01:00 [INF] Request finished in 10.7199ms 200 application/javascript
2019-02-19 11:15:55.140 +01:00 [INF] Sending file. Request path: '/css/site.min.css'. Physical path: 'C:\git\damienbod\AspNetCoreHybridFlowWithApi\StsServer\wwwroot\css\site.min.css'
2019-02-19 11:15:55.140 +01:00 [INF] Request finished in 21.519ms 200 text/css
2019-02-19 11:15:55.166 +01:00 [INF] Sending file. Request path: '/css/vendor.min.css'. Physical path: 'C:\git\damienbod\AspNetCoreHybridFlowWithApi\StsServer\wwwroot\css\vendor.min.css'
2019-02-19 11:15:55.166 +01:00 [INF] Request finished in 53.1093ms 200 text/css
2019-02-19 11:15:55.166 +01:00 [INF] Sending file. Request path: '/js/vendor.min.js'. Physical path: 'C:\git\damienbod\AspNetCoreHybridFlowWithApi\StsServer\wwwroot\js\vendor.min.js'
2019-02-19 11:15:55.168 +01:00 [INF] Request finished in 43.245ms 200 application/javascript
2019-02-19 11:16:53.879 +01:00 [INF] User profile is available. Using 'C:\Users\stduser\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2019-02-19 11:16:54.318 +01:00 [INF] Starting IdentityServer4 version 2.3.2.0
2019-02-19 11:16:54.360 +01:00 [INF] You are using the in-memory version of the persisted grant store. This will store consent decisions, authorization codes, refresh and reference tokens in memory only. If you are using any of those features in production, you want to switch to a different store implementation.
2019-02-19 11:16:54.410 +01:00 [INF] Using the default authentication scheme Identity.Application for IdentityServer
2019-02-19 11:16:57.448 +01:00 [INF] Request starting HTTP/1.1 GET http://localhost:44352/.well-known/openid-configuration  
2019-02-19 11:16:57.449 +01:00 [INF] Request starting HTTP/1.1 DEBUG http://localhost:44352/  0
2019-02-19 11:16:57.448 +01:00 [INF] Request starting HTTP/1.1 GET http://localhost:44352/  
2019-02-19 11:16:57.545 +01:00 [INF] Request finished in 78.6564ms 200 
2019-02-19 11:16:58.666 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-02-19 11:16:58.748 +01:00 [INF] Executing endpoint 'StsServerIdentity.Controllers.HomeController.Index (StsServerIdentity)'
2019-02-19 11:16:58.788 +01:00 [INF] Route matched with {action = "Index", controller = "Home"}. Executing action StsServerIdentity.Controllers.HomeController.Index (StsServerIdentity)
2019-02-19 11:16:58.896 +01:00 [INF] Executing action method StsServerIdentity.Controllers.HomeController.Index (StsServerIdentity) - Validation state: "Valid"
2019-02-19 11:16:58.912 +01:00 [INF] Executed action method StsServerIdentity.Controllers.HomeController.Index (StsServerIdentity), returned result Microsoft.AspNetCore.Mvc.ViewResult in 1.0327ms.
2019-02-19 11:16:58.917 +01:00 [INF] Request finished in 1477.8363ms 200 application/json; charset=UTF-8
2019-02-19 11:16:58.961 +01:00 [INF] Request starting HTTP/1.1 GET http://localhost:44352/.well-known/openid-configuration/jwks  
2019-02-19 11:16:58.962 +01:00 [INF] Executing ViewResult, running view Index.
2019-02-19 11:16:58.963 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2019-02-19 11:16:59.034 +01:00 [INF] Request finished in 72.9866ms 200 application/jwk-set+json; charset=UTF-8
2019-02-19 11:16:59.338 +01:00 [INF] Request starting HTTP/1.1 POST http://localhost:44352/connect/token application/x-www-form-urlencoded 72
2019-02-19 11:16:59.437 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.TokenEndpoint for /connect/token
2019-02-19 11:16:59.718 +01:00 [INF] Executed ViewResult - view Index executed in 787.6674ms.
2019-02-19 11:16:59.719 +01:00 [INF] Executed action StsServerIdentity.Controllers.HomeController.Index (StsServerIdentity) in 930.2996ms
2019-02-19 11:16:59.720 +01:00 [INF] Executed endpoint 'StsServerIdentity.Controllers.HomeController.Index (StsServerIdentity)'
2019-02-19 11:16:59.726 +01:00 [INF] Request finished in 2286.9506ms 200 text/html; charset=utf-8
2019-02-19 11:16:59.745 +01:00 [INF] Request starting HTTP/1.1 GET http://localhost:44352/css/vendor.min.css?v=RtIwopEx0osLqdXB1F1QPDFWzutpmmdukcoICaRWUFI  
2019-02-19 11:16:59.758 +01:00 [INF] Request starting HTTP/1.1 GET http://localhost:44352/css/site.min.css?v=9n42HB2zuqXKDsr8sMaXB5eFvO87SuAf1CjiV4cv1Fg  
2019-02-19 11:16:59.761 +01:00 [INF] The file /css/vendor.min.css was not modified
2019-02-19 11:16:59.761 +01:00 [INF] The file /css/site.min.css was not modified
2019-02-19 11:16:59.761 +01:00 [INF] Request starting HTTP/1.1 GET http://localhost:44352/js/site.min.js?v=47DEQpj8HBSa-_TImW-5JCeuQeRkm5NMpJWZG3hSuFU  
2019-02-19 11:16:59.763 +01:00 [INF] Request starting HTTP/1.1 GET http://localhost:44352/js/vendor.min.js?v=yg3700ylkpEbw8o9sR1SsYLHNI0v7pw6lI42YH1q40o  
2019-02-19 11:16:59.763 +01:00 [INF] The file /js/site.min.js was not modified
2019-02-19 11:16:59.763 +01:00 [INF] The file /js/vendor.min.js was not modified
2019-02-19 11:16:59.765 +01:00 [INF] Request finished in 2.5144ms 304 application/javascript
2019-02-19 11:16:59.765 +01:00 [INF] Request finished in 20.7403ms 304 text/css
2019-02-19 11:16:59.765 +01:00 [INF] Request finished in 4.607ms 304 application/javascript
2019-02-19 11:16:59.765 +01:00 [INF] Request finished in 7.7192ms 304 text/css
2019-02-19 11:16:59.811 +01:00 [INF] Token request validation success
{"ClientId":"ProtectedApi","ClientName":"ProtectedApi","GrantType":"client_credentials","Scopes":"scope_used_for_api_in_protected_zone","AuthorizationCode":null,"RefreshToken":null,"UserName":null,"AuthenticationContextReferenceClasses":null,"Tenant":null,"IdP":null,"Raw":{"grant_type":"client_credentials","scope":"scope_used_for_api_in_protected_zone"},"$type":"TokenRequestValidationLog"}
2019-02-19 11:16:59.952 +01:00 [INF] Request finished in 614.07ms 200 application/json; charset=UTF-8
2019-02-19 11:17:00.306 +01:00 [INF] Request starting HTTP/1.1 GET http://localhost:44352/.well-known/openid-configuration  
2019-02-19 11:17:00.307 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-02-19 11:17:00.307 +01:00 [INF] Request finished in 1.5791ms 200 application/json; charset=UTF-8
2019-02-19 11:17:00.430 +01:00 [INF] Request starting HTTP/1.1 GET http://localhost:44352/.well-known/openid-configuration/jwks  
2019-02-19 11:17:00.431 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2019-02-19 11:17:00.431 +01:00 [INF] Request finished in 1.0584ms 200 application/jwk-set+json; charset=UTF-8
2019-02-19 11:17:09.601 +01:00 [INF] Request starting HTTP/1.1 GET http://localhost:44352/.well-known/openid-configuration  
2019-02-19 11:17:09.602 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-02-19 11:17:09.602 +01:00 [INF] Request finished in 1.1869ms 200 application/json; charset=UTF-8
2019-02-19 11:17:09.637 +01:00 [INF] Request starting HTTP/1.1 GET http://localhost:44352/.well-known/openid-configuration/jwks  
2019-02-19 11:17:09.638 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2019-02-19 11:17:09.638 +01:00 [INF] Request finished in 0.8901ms 200 application/jwk-set+json; charset=UTF-8
2019-02-19 11:17:09.733 +01:00 [INF] Request starting HTTP/1.1 POST http://localhost:44352/connect/deviceauthorization application/x-www-form-urlencoded 29
2019-02-19 11:17:09.734 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DeviceAuthorizationEndpoint for /connect/deviceauthorization
2019-02-19 11:17:09.769 +01:00 [INF] Request finished in 36.4329ms 200 application/json; charset=UTF-8
2019-02-19 11:17:15.149 +01:00 [INF] Request starting HTTP/1.1 GET http://localhost:44352/device  
2019-02-19 11:17:15.161 +01:00 [INF] Executing endpoint 'StsServerIdentity.Controllers.DeviceController.Index (StsServerIdentity)'
2019-02-19 11:17:15.184 +01:00 [INF] Route matched with {action = "Index", controller = "Device"}. Executing action StsServerIdentity.Controllers.DeviceController.Index (StsServerIdentity)
2019-02-19 11:17:15.200 +01:00 [INF] Authorization was successful.
2019-02-19 11:17:15.249 +01:00 [INF] Executing action method StsServerIdentity.Controllers.DeviceController.Index (StsServerIdentity) with arguments ([""]) - Validation state: "Valid"
2019-02-19 11:17:15.255 +01:00 [INF] Executed action method StsServerIdentity.Controllers.DeviceController.Index (StsServerIdentity), returned result Microsoft.AspNetCore.Mvc.ViewResult in 3.4167ms.
2019-02-19 11:17:15.258 +01:00 [INF] Executing ViewResult, running view UserCodeCapture.
2019-02-19 11:17:15.268 +01:00 [INF] Executed ViewResult - view UserCodeCapture executed in 12.7005ms.
2019-02-19 11:17:15.268 +01:00 [INF] Executed action StsServerIdentity.Controllers.DeviceController.Index (StsServerIdentity) in 83.945100000000011ms
2019-02-19 11:17:15.268 +01:00 [INF] Executed endpoint 'StsServerIdentity.Controllers.DeviceController.Index (StsServerIdentity)'
2019-02-19 11:17:15.268 +01:00 [INF] Request finished in 119.2377ms 200 text/html; charset=utf-8
2019-02-19 11:17:15.493 +01:00 [INF] Request starting HTTP/1.1 GET http://localhost:44352/device  
2019-02-19 11:17:15.496 +01:00 [INF] Executing endpoint 'StsServerIdentity.Controllers.DeviceController.Index (StsServerIdentity)'
2019-02-19 11:17:15.496 +01:00 [INF] Route matched with {action = "Index", controller = "Device"}. Executing action StsServerIdentity.Controllers.DeviceController.Index (StsServerIdentity)
2019-02-19 11:17:15.497 +01:00 [INF] Authorization was successful.
2019-02-19 11:17:15.540 +01:00 [INF] Executing action method StsServerIdentity.Controllers.DeviceController.Index (StsServerIdentity) with arguments ([""]) - Validation state: "Valid"
2019-02-19 11:17:15.540 +01:00 [INF] Executed action method StsServerIdentity.Controllers.DeviceController.Index (StsServerIdentity), returned result Microsoft.AspNetCore.Mvc.ViewResult in 0.1696ms.
2019-02-19 11:17:15.541 +01:00 [INF] Executing ViewResult, running view UserCodeCapture.
2019-02-19 11:17:15.547 +01:00 [INF] Executed ViewResult - view UserCodeCapture executed in 6.4688ms.
2019-02-19 11:17:15.547 +01:00 [INF] Executed action StsServerIdentity.Controllers.DeviceController.Index (StsServerIdentity) in 50.7927ms
2019-02-19 11:17:15.547 +01:00 [INF] Executed endpoint 'StsServerIdentity.Controllers.DeviceController.Index (StsServerIdentity)'
2019-02-19 11:17:15.547 +01:00 [INF] Request finished in 54.3844ms 200 text/html; charset=utf-8
2019-02-19 11:17:23.818 +01:00 [INF] Request starting HTTP/1.1 POST http://localhost:44352/Device/UserCodeCapture application/x-www-form-urlencoded 244
2019-02-19 11:17:23.852 +01:00 [INF] Executing endpoint 'StsServerIdentity.Controllers.DeviceController.UserCodeCapture (StsServerIdentity)'
2019-02-19 11:17:23.859 +01:00 [INF] Route matched with {action = "UserCodeCapture", controller = "Device"}. Executing action StsServerIdentity.Controllers.DeviceController.UserCodeCapture (StsServerIdentity)
2019-02-19 11:17:23.859 +01:00 [INF] Authorization was successful.
2019-02-19 11:17:23.902 +01:00 [INF] Executing action method StsServerIdentity.Controllers.DeviceController.UserCodeCapture (StsServerIdentity) with arguments (["420630209"]) - Validation state: "Valid"
2019-02-19 11:17:23.914 +01:00 [INF] Executed action method StsServerIdentity.Controllers.DeviceController.UserCodeCapture (StsServerIdentity), returned result Microsoft.AspNetCore.Mvc.ViewResult in 12.091600000000001ms.
2019-02-19 11:17:23.917 +01:00 [INF] Executing ViewResult, running view UserCodeConfirmation.
2019-02-19 11:17:24.076 +01:00 [INF] Executed ViewResult - view UserCodeConfirmation executed in 162.0265ms.
2019-02-19 11:17:24.076 +01:00 [INF] Executed action StsServerIdentity.Controllers.DeviceController.UserCodeCapture (StsServerIdentity) in 217.49030000000002ms
2019-02-19 11:17:24.076 +01:00 [INF] Executed endpoint 'StsServerIdentity.Controllers.DeviceController.UserCodeCapture (StsServerIdentity)'
2019-02-19 11:17:24.077 +01:00 [INF] Request finished in 259.6774ms 200 text/html; charset=utf-8
2019-02-19 11:17:25.536 +01:00 [INF] Request starting HTTP/1.1 POST http://localhost:44352/Device/Callback application/x-www-form-urlencoded 398
2019-02-19 11:17:25.546 +01:00 [INF] Executing endpoint 'StsServerIdentity.Controllers.DeviceController.Callback (StsServerIdentity)'
2019-02-19 11:17:25.574 +01:00 [INF] Route matched with {action = "Callback", controller = "Device"}. Executing action StsServerIdentity.Controllers.DeviceController.Callback (StsServerIdentity)
2019-02-19 11:17:25.574 +01:00 [INF] Authorization was successful.
2019-02-19 11:17:25.722 +01:00 [INF] Executing action method StsServerIdentity.Controllers.DeviceController.Callback (StsServerIdentity) with arguments (["StsServerIdentity.Models.DeviceAuthorizationInputModel"]) - Validation state: "Valid"
2019-02-19 11:17:25.748 +01:00 [INF] Executed action method StsServerIdentity.Controllers.DeviceController.Callback (StsServerIdentity), returned result Microsoft.AspNetCore.Mvc.ViewResult in 25.245ms.
2019-02-19 11:17:25.753 +01:00 [INF] Executing ViewResult, running view Success.
2019-02-19 11:17:25.762 +01:00 [INF] Executed ViewResult - view Success executed in 13.525300000000001ms.
2019-02-19 11:17:25.762 +01:00 [INF] Executed action StsServerIdentity.Controllers.DeviceController.Callback (StsServerIdentity) in 187.8132ms
2019-02-19 11:17:25.762 +01:00 [INF] Executed endpoint 'StsServerIdentity.Controllers.DeviceController.Callback (StsServerIdentity)'
2019-02-19 11:17:25.762 +01:00 [INF] Request finished in 225.9354ms 200 text/html; charset=utf-8
2019-02-19 11:17:42.184 +01:00 [INF] Request starting HTTP/1.1 GET http://localhost:44352/.well-known/openid-configuration  
2019-02-19 11:17:42.185 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-02-19 11:17:42.185 +01:00 [INF] Request finished in 1.4225ms 200 application/json; charset=UTF-8
2019-02-19 11:17:42.209 +01:00 [INF] Request starting HTTP/1.1 GET http://localhost:44352/.well-known/openid-configuration/jwks  
2019-02-19 11:17:42.209 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2019-02-19 11:17:42.210 +01:00 [INF] Request finished in 1.1626ms 200 application/jwk-set+json; charset=UTF-8
2019-02-19 11:17:42.232 +01:00 [INF] Request starting HTTP/1.1 POST http://localhost:44352/connect/token application/x-www-form-urlencoded 172
2019-02-19 11:17:42.233 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.TokenEndpoint for /connect/token
2019-02-19 11:17:42.896 +01:00 [INF] Entity Framework Core 2.2.2-servicing-10034 initialized 'ApplicationDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer' with options: None
2019-02-19 11:17:43.700 +01:00 [INF] Executed DbCommand (54ms) [Parameters=[@__get_Item_0='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [e].[Id], [e].[AccessFailedCount], [e].[ConcurrencyStamp], [e].[DataEventRecordsRole], [e].[Email], [e].[EmailConfirmed], [e].[IsAdmin], [e].[LockoutEnabled], [e].[LockoutEnd], [e].[NormalizedEmail], [e].[NormalizedUserName], [e].[PasswordHash], [e].[PhoneNumber], [e].[PhoneNumberConfirmed], [e].[SecuredFilesRole], [e].[SecurityStamp], [e].[TwoFactorEnabled], [e].[UserName]
FROM [AspNetUsers] AS [e]
WHERE [e].[Id] = @__get_Item_0
2019-02-19 11:17:43.818 +01:00 [INF] Token request validation success
{"ClientId":"deviceFlowWebClient","ClientName":"Device Flow Client","GrantType":"urn:ietf:params:oauth:grant-type:device_code","Scopes":null,"AuthorizationCode":null,"RefreshToken":null,"UserName":null,"AuthenticationContextReferenceClasses":null,"Tenant":null,"IdP":null,"Raw":{"device_code":"***REDACTED***","grant_type":"urn:ietf:params:oauth:grant-type:device_code","client_id":"deviceFlowWebClient"},"$type":"TokenRequestValidationLog"}
2019-02-19 11:17:43.976 +01:00 [INF] Executed DbCommand (56ms) [Parameters=[@__user_Id_0='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT [uc].[Id], [uc].[ClaimType], [uc].[ClaimValue], [uc].[UserId]
FROM [AspNetUserClaims] AS [uc]
WHERE [uc].[UserId] = @__user_Id_0
2019-02-19 11:17:44.048 +01:00 [INF] Executed DbCommand (19ms) [Parameters=[@__userId_0='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT [role].[Name]
FROM [AspNetUserRoles] AS [userRole]
INNER JOIN [AspNetRoles] AS [role] ON [userRole].[RoleId] = [role].[Id]
WHERE [userRole].[UserId] = @__userId_0
2019-02-19 11:17:44.119 +01:00 [INF] Request finished in 1886.5634ms 200 application/json; charset=UTF-8
2019-02-19 11:46:30.397 +01:00 [INF] User profile is available. Using 'C:\Users\stduser\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2019-02-19 11:46:30.832 +01:00 [INF] Starting IdentityServer4 version 2.3.2.0
2019-02-19 11:46:30.861 +01:00 [INF] You are using the in-memory version of the persisted grant store. This will store consent decisions, authorization codes, refresh and reference tokens in memory only. If you are using any of those features in production, you want to switch to a different store implementation.
2019-02-19 11:46:30.885 +01:00 [INF] Using the default authentication scheme Identity.Application for IdentityServer
2019-02-19 11:46:33.676 +01:00 [INF] Request starting HTTP/1.1 GET http://localhost:44352/  
2019-02-19 11:46:33.676 +01:00 [INF] Request starting HTTP/1.1 DEBUG http://localhost:44352/  0
2019-02-19 11:46:33.734 +01:00 [INF] Request finished in 51.2683ms 200 
2019-02-19 11:46:34.737 +01:00 [INF] Request starting HTTP/1.1 GET http://localhost:44352/.well-known/openid-configuration  
2019-02-19 11:46:34.867 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-02-19 11:46:35.039 +01:00 [INF] Request finished in 302.5031ms 200 application/json; charset=UTF-8
2019-02-19 11:46:35.162 +01:00 [INF] Request starting HTTP/1.1 GET http://localhost:44352/.well-known/openid-configuration/jwks  
2019-02-19 11:46:35.165 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2019-02-19 11:46:35.249 +01:00 [INF] Request finished in 87.8545ms 200 application/jwk-set+json; charset=UTF-8
2019-02-19 11:46:35.328 +01:00 [INF] Request starting HTTP/1.1 GET http://localhost:44352/connect/authorize?client_id=hybridclient&redirect_uri=https%3A%2F%2Flocalhost%3A44329%2Fsignin-oidc&response_type=code%20id_token&scope=openid%20profile%20scope_used_for_hybrid_flow%20offline_access&response_mode=form_post&nonce=636861699952960844.ZGIxMDc0Y2EtZTYzZC00OGMyLTkzOTMtYzlhYmE1MjU1YjIxODk2ZTc4NjAtZGE5ZC00MjAwLWJiMGUtMjAyZTJjYTRlMTQy&state=CfDJ8CGpEylrt0pIt6txpyTWMbTndKG4vBMWiDYs7VscsX7788sH1J8t9m5ZQPgFPn3WZIa5vN3qJPEVY8D9DtxROnsA7CMPJSJ_lcb0VqF8HyktVb1l_ajQki1HmvsqDYJA1K7PmGgbjzd8TTATYjbeRLvnaBDDVA3_fXAz0mOFoJcws4FwIAn5kMExMdQ9Y8RlWLIm939y1ZBQK532DNjnl3rxEzYaOqXb3cLTXjniIvy2UpxwEB2gUOOiQZzrgrriRqvQ6oBdxR8k__Pfj6xYDfKWk4aiVweTulGUheOWjM-8KE3x1MbnwyxP72b8hFzZZaRXz1XfNkZAaB8XTTB_wY0&x-client-SKU=ID_NETSTANDARD2_0&x-client-ver=5.3.0.0  
2019-02-19 11:46:35.826 +01:00 [INF] Entity Framework Core 2.2.2-servicing-10034 initialized 'ApplicationDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer' with options: None
2019-02-19 11:46:35.826 +01:00 [INF] Entity Framework Core 2.2.2-servicing-10034 initialized 'ApplicationDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer' with options: None
2019-02-19 11:46:36.904 +01:00 [INF] Executed DbCommand (138ms) [Parameters=[@__get_Item_0='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [e].[Id], [e].[AccessFailedCount], [e].[ConcurrencyStamp], [e].[DataEventRecordsRole], [e].[Email], [e].[EmailConfirmed], [e].[IsAdmin], [e].[LockoutEnabled], [e].[LockoutEnd], [e].[NormalizedEmail], [e].[NormalizedUserName], [e].[PasswordHash], [e].[PhoneNumber], [e].[PhoneNumberConfirmed], [e].[SecuredFilesRole], [e].[SecurityStamp], [e].[TwoFactorEnabled], [e].[UserName]
FROM [AspNetUsers] AS [e]
WHERE [e].[Id] = @__get_Item_0
2019-02-19 11:46:36.904 +01:00 [INF] Executed DbCommand (138ms) [Parameters=[@__get_Item_0='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [e].[Id], [e].[AccessFailedCount], [e].[ConcurrencyStamp], [e].[DataEventRecordsRole], [e].[Email], [e].[EmailConfirmed], [e].[IsAdmin], [e].[LockoutEnabled], [e].[LockoutEnd], [e].[NormalizedEmail], [e].[NormalizedUserName], [e].[PasswordHash], [e].[PhoneNumber], [e].[PhoneNumberConfirmed], [e].[SecuredFilesRole], [e].[SecurityStamp], [e].[TwoFactorEnabled], [e].[UserName]
FROM [AspNetUsers] AS [e]
WHERE [e].[Id] = @__get_Item_0
2019-02-19 11:46:37.388 +01:00 [INF] Executed DbCommand (135ms) [Parameters=[@__user_Id_0='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT [uc].[Id], [uc].[ClaimType], [uc].[ClaimValue], [uc].[UserId]
FROM [AspNetUserClaims] AS [uc]
WHERE [uc].[UserId] = @__user_Id_0
2019-02-19 11:46:37.390 +01:00 [INF] Executed DbCommand (137ms) [Parameters=[@__user_Id_0='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT [uc].[Id], [uc].[ClaimType], [uc].[ClaimValue], [uc].[UserId]
FROM [AspNetUserClaims] AS [uc]
WHERE [uc].[UserId] = @__user_Id_0
2019-02-19 11:46:37.503 +01:00 [INF] Executed DbCommand (34ms) [Parameters=[@__userId_0='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT [role].[Name]
FROM [AspNetUserRoles] AS [userRole]
INNER JOIN [AspNetRoles] AS [role] ON [userRole].[RoleId] = [role].[Id]
WHERE [userRole].[UserId] = @__userId_0
2019-02-19 11:46:37.503 +01:00 [INF] Executed DbCommand (34ms) [Parameters=[@__userId_0='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT [role].[Name]
FROM [AspNetUserRoles] AS [userRole]
INNER JOIN [AspNetRoles] AS [role] ON [userRole].[RoleId] = [role].[Id]
WHERE [userRole].[UserId] = @__userId_0
2019-02-19 11:46:37.542 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2019-02-19 11:46:37.580 +01:00 [INF] Executing endpoint 'StsServerIdentity.Controllers.HomeController.Index (StsServerIdentity)'
2019-02-19 11:46:37.599 +01:00 [INF] Route matched with {action = "Index", controller = "Home"}. Executing action StsServerIdentity.Controllers.HomeController.Index (StsServerIdentity)
2019-02-19 11:46:37.699 +01:00 [INF] Executing action method StsServerIdentity.Controllers.HomeController.Index (StsServerIdentity) - Validation state: "Valid"
2019-02-19 11:46:37.703 +01:00 [INF] Executed action method StsServerIdentity.Controllers.HomeController.Index (StsServerIdentity), returned result Microsoft.AspNetCore.Mvc.ViewResult in 0.8489ms.
2019-02-19 11:46:37.744 +01:00 [INF] Executing ViewResult, running view Index.
2019-02-19 11:46:37.748 +01:00 [INF] ValidatedAuthorizeRequest
{"ClientId":"hybridclient","ClientName":"hybridclient","RedirectUri":"https://localhost:44329/signin-oidc","AllowedRedirectUris":["https://localhost:44329/signin-oidc"],"SubjectId":"06283e9f-fb29-4334-9bab-ad5409e1eb30","ResponseType":"code id_token","ResponseMode":"form_post","GrantType":"hybrid","RequestedScopes":"openid profile scope_used_for_hybrid_flow offline_access","State":"CfDJ8CGpEylrt0pIt6txpyTWMbTndKG4vBMWiDYs7VscsX7788sH1J8t9m5ZQPgFPn3WZIa5vN3qJPEVY8D9DtxROnsA7CMPJSJ_lcb0VqF8HyktVb1l_ajQki1HmvsqDYJA1K7PmGgbjzd8TTATYjbeRLvnaBDDVA3_fXAz0mOFoJcws4FwIAn5kMExMdQ9Y8RlWLIm939y1ZBQK532DNjnl3rxEzYaOqXb3cLTXjniIvy2UpxwEB2gUOOiQZzrgrriRqvQ6oBdxR8k__Pfj6xYDfKWk4aiVweTulGUheOWjM-8KE3x1MbnwyxP72b8hFzZZaRXz1XfNkZAaB8XTTB_wY0","UiLocales":null,"Nonce":"636861699952960844.ZGIxMDc0Y2EtZTYzZC00OGMyLTkzOTMtYzlhYmE1MjU1YjIxODk2ZTc4NjAtZGE5ZC00MjAwLWJiMGUtMjAyZTJjYTRlMTQy","AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":"797e191e5b9eba170c23e1d44dc27030","Raw":{"client_id":"hybridclient","redirect_uri":"https://localhost:44329/signin-oidc","response_type":"code id_token","scope":"openid profile scope_used_for_hybrid_flow offline_access","response_mode":"form_post","nonce":"636861699952960844.ZGIxMDc0Y2EtZTYzZC00OGMyLTkzOTMtYzlhYmE1MjU1YjIxODk2ZTc4NjAtZGE5ZC00MjAwLWJiMGUtMjAyZTJjYTRlMTQy","state":"CfDJ8CGpEylrt0pIt6txpyTWMbTndKG4vBMWiDYs7VscsX7788sH1J8t9m5ZQPgFPn3WZIa5vN3qJPEVY8D9DtxROnsA7CMPJSJ_lcb0VqF8HyktVb1l_ajQki1HmvsqDYJA1K7PmGgbjzd8TTATYjbeRLvnaBDDVA3_fXAz0mOFoJcws4FwIAn5kMExMdQ9Y8RlWLIm939y1ZBQK532DNjnl3rxEzYaOqXb3cLTXjniIvy2UpxwEB2gUOOiQZzrgrriRqvQ6oBdxR8k__Pfj6xYDfKWk4aiVweTulGUheOWjM-8KE3x1MbnwyxP72b8hFzZZaRXz1XfNkZAaB8XTTB_wY0","x-client-SKU":"ID_NETSTANDARD2_0","x-client-ver":"5.3.0.0"},"$type":"AuthorizeRequestValidationLog"}
2019-02-19 11:46:37.803 +01:00 [INF] Showing consent: User has not yet consented
2019-02-19 11:46:37.842 +01:00 [INF] Request finished in 2513.5827ms 302 
2019-02-19 11:46:37.846 +01:00 [INF] Request starting HTTP/1.1 GET http://localhost:44352/consent?returnUrl=%2Fconnect%2Fauthorize%2Fcallback%3Fclient_id%3Dhybridclient%26redirect_uri%3Dhttps%253A%252F%252Flocalhost%253A44329%252Fsignin-oidc%26response_type%3Dcode%2520id_token%26scope%3Dopenid%2520profile%2520scope_used_for_hybrid_flow%2520offline_access%26response_mode%3Dform_post%26nonce%3D636861699952960844.ZGIxMDc0Y2EtZTYzZC00OGMyLTkzOTMtYzlhYmE1MjU1YjIxODk2ZTc4NjAtZGE5ZC00MjAwLWJiMGUtMjAyZTJjYTRlMTQy%26state%3DCfDJ8CGpEylrt0pIt6txpyTWMbTndKG4vBMWiDYs7VscsX7788sH1J8t9m5ZQPgFPn3WZIa5vN3qJPEVY8D9DtxROnsA7CMPJSJ_lcb0VqF8HyktVb1l_ajQki1HmvsqDYJA1K7PmGgbjzd8TTATYjbeRLvnaBDDVA3_fXAz0mOFoJcws4FwIAn5kMExMdQ9Y8RlWLIm939y1ZBQK532DNjnl3rxEzYaOqXb3cLTXjniIvy2UpxwEB2gUOOiQZzrgrriRqvQ6oBdxR8k__Pfj6xYDfKWk4aiVweTulGUheOWjM-8KE3x1MbnwyxP72b8hFzZZaRXz1XfNkZAaB8XTTB_wY0%26x-client-SKU%3DID_NETSTANDARD2_0%26x-client-ver%3D5.3.0.0  
2019-02-19 11:46:37.856 +01:00 [INF] Executing endpoint 'StsServerIdentity.Controllers.ConsentController.Index (StsServerIdentity)'
2019-02-19 11:46:37.886 +01:00 [INF] Route matched with {action = "Index", controller = "Consent"}. Executing action StsServerIdentity.Controllers.ConsentController.Index (StsServerIdentity)
2019-02-19 11:46:37.960 +01:00 [INF] Executing action method StsServerIdentity.Controllers.ConsentController.Index (StsServerIdentity) with arguments (["/connect/authorize/callback?client_id=hybridclient&redirect_uri=https%3A%2F%2Flocalhost%3A44329%2Fsignin-oidc&response_type=code%20id_token&scope=openid%20profile%20scope_used_for_hybrid_flow%20offline_access&response_mode=form_post&nonce=636861699952960844.ZGIxMDc0Y2EtZTYzZC00OGMyLTkzOTMtYzlhYmE1MjU1YjIxODk2ZTc4NjAtZGE5ZC00MjAwLWJiMGUtMjAyZTJjYTRlMTQy&state=CfDJ8CGpEylrt0pIt6txpyTWMbTndKG4vBMWiDYs7VscsX7788sH1J8t9m5ZQPgFPn3WZIa5vN3qJPEVY8D9DtxROnsA7CMPJSJ_lcb0VqF8HyktVb1l_ajQki1HmvsqDYJA1K7PmGgbjzd8TTATYjbeRLvnaBDDVA3_fXAz0mOFoJcws4FwIAn5kMExMdQ9Y8RlWLIm939y1ZBQK532DNjnl3rxEzYaOqXb3cLTXjniIvy2UpxwEB2gUOOiQZzrgrriRqvQ6oBdxR8k__Pfj6xYDfKWk4aiVweTulGUheOWjM-8KE3x1MbnwyxP72b8hFzZZaRXz1XfNkZAaB8XTTB_wY0&x-client-SKU=ID_NETSTANDARD2_0&x-client-ver=5.3.0.0"]) - Validation state: "Valid"
2019-02-19 11:46:38.215 +01:00 [INF] Executed action method StsServerIdentity.Controllers.ConsentController.Index (StsServerIdentity), returned result Microsoft.AspNetCore.Mvc.ViewResult in 254.8153ms.
2019-02-19 11:46:38.219 +01:00 [INF] Executing ViewResult, running view Index.
2019-02-19 11:46:38.516 +01:00 [INF] Executed ViewResult - view Index executed in 791.35620000000006ms.
2019-02-19 11:46:38.517 +01:00 [INF] Executed action StsServerIdentity.Controllers.HomeController.Index (StsServerIdentity) in 917.40410000000008ms
2019-02-19 11:46:38.518 +01:00 [INF] Executed endpoint 'StsServerIdentity.Controllers.HomeController.Index (StsServerIdentity)'
2019-02-19 11:46:38.664 +01:00 [INF] Request finished in 4992.7946ms 200 text/html; charset=utf-8
2019-02-19 11:46:38.673 +01:00 [INF] Executed ViewResult - view Index executed in 457.2278ms.
2019-02-19 11:46:38.673 +01:00 [INF] Executed action StsServerIdentity.Controllers.ConsentController.Index (StsServerIdentity) in 786.8713ms
2019-02-19 11:46:38.673 +01:00 [INF] Executed endpoint 'StsServerIdentity.Controllers.ConsentController.Index (StsServerIdentity)'
2019-02-19 11:46:38.673 +01:00 [INF] Request finished in 827.4328ms 200 text/html; charset=utf-8
2019-02-19 11:46:38.694 +01:00 [INF] Request starting HTTP/1.1 GET http://localhost:44352/css/vendor.min.css?v=RtIwopEx0osLqdXB1F1QPDFWzutpmmdukcoICaRWUFI  
2019-02-19 11:46:38.706 +01:00 [INF] Request starting HTTP/1.1 GET http://localhost:44352/js/vendor.min.js?v=yg3700ylkpEbw8o9sR1SsYLHNI0v7pw6lI42YH1q40o  
2019-02-19 11:46:38.706 +01:00 [INF] Request starting HTTP/1.1 GET http://localhost:44352/js/site.min.js?v=47DEQpj8HBSa-_TImW-5JCeuQeRkm5NMpJWZG3hSuFU  
2019-02-19 11:46:38.707 +01:00 [INF] Request starting HTTP/1.1 GET http://localhost:44352/css/site.min.css?v=9n42HB2zuqXKDsr8sMaXB5eFvO87SuAf1CjiV4cv1Fg  
2019-02-19 11:46:38.726 +01:00 [INF] The file /css/vendor.min.css was not modified
2019-02-19 11:46:38.726 +01:00 [INF] The file /js/vendor.min.js was not modified
2019-02-19 11:46:38.727 +01:00 [INF] The file /js/site.min.js was not modified
2019-02-19 11:46:38.727 +01:00 [INF] The file /css/site.min.css was not modified
2019-02-19 11:46:38.732 +01:00 [INF] Request finished in 26.4746ms 304 text/css
2019-02-19 11:46:38.732 +01:00 [INF] Request finished in 38.0601ms 304 text/css
2019-02-19 11:46:38.732 +01:00 [INF] Request finished in 26.7282ms 304 application/javascript
2019-02-19 11:46:38.732 +01:00 [INF] Request finished in 26.6923ms 304 application/javascript
2019-02-19 11:46:55.357 +01:00 [INF] Request starting HTTP/1.1 GET http://localhost:44352/.well-known/openid-configuration  
2019-02-19 11:46:55.357 +01:00 [INF] Request starting HTTP/1.1 GET http://localhost:44352/.well-known/openid-configuration  
2019-02-19 11:46:55.358 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-02-19 11:46:55.358 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-02-19 11:46:55.358 +01:00 [INF] Request finished in 1.3915ms 200 application/json; charset=UTF-8
2019-02-19 11:46:55.358 +01:00 [INF] Request finished in 1.3934ms 200 application/json; charset=UTF-8
2019-02-19 11:46:55.405 +01:00 [INF] Request starting HTTP/1.1 GET http://localhost:44352/.well-known/openid-configuration/jwks  
2019-02-19 11:46:55.405 +01:00 [INF] Request starting HTTP/1.1 GET http://localhost:44352/.well-known/openid-configuration/jwks  
2019-02-19 11:46:55.406 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2019-02-19 11:46:55.406 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2019-02-19 11:46:55.407 +01:00 [INF] Request finished in 1.1534ms 200 application/jwk-set+json; charset=UTF-8
2019-02-19 11:46:55.407 +01:00 [INF] Request finished in 1.1379ms 200 application/jwk-set+json; charset=UTF-8
2019-02-19 11:46:55.534 +01:00 [INF] Request starting HTTP/1.1 POST http://localhost:44352/connect/deviceauthorization application/x-www-form-urlencoded 56
2019-02-19 11:46:55.534 +01:00 [INF] Request starting HTTP/1.1 POST http://localhost:44352/connect/deviceauthorization application/x-www-form-urlencoded 56
2019-02-19 11:46:55.537 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DeviceAuthorizationEndpoint for /connect/deviceauthorization
2019-02-19 11:46:55.537 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DeviceAuthorizationEndpoint for /connect/deviceauthorization
2019-02-19 11:46:55.608 +01:00 [INF] Request finished in 74.2622ms 200 application/json; charset=UTF-8
2019-02-19 11:46:55.608 +01:00 [INF] Request finished in 74.3534ms 200 application/json; charset=UTF-8
2019-02-19 11:47:01.969 +01:00 [INF] Request starting HTTP/1.1 GET http://localhost:44352/device  
2019-02-19 11:47:02.001 +01:00 [INF] Executing endpoint 'StsServerIdentity.Controllers.DeviceController.Index (StsServerIdentity)'
2019-02-19 11:47:02.010 +01:00 [INF] Route matched with {action = "Index", controller = "Device"}. Executing action StsServerIdentity.Controllers.DeviceController.Index (StsServerIdentity)
2019-02-19 11:47:02.026 +01:00 [INF] Authorization failed.
2019-02-19 11:47:02.026 +01:00 [INF] Authorization failed for the request at filter 'Microsoft.AspNetCore.Mvc.Authorization.AuthorizeFilter'.
2019-02-19 11:47:02.031 +01:00 [INF] Executing ChallengeResult with authentication schemes ([]).
2019-02-19 11:47:02.038 +01:00 [INF] AuthenticationScheme: Identity.Application was challenged.
2019-02-19 11:47:02.039 +01:00 [INF] Executed action StsServerIdentity.Controllers.DeviceController.Index (StsServerIdentity) in 28.287000000000003ms
2019-02-19 11:47:02.039 +01:00 [INF] Executed endpoint 'StsServerIdentity.Controllers.DeviceController.Index (StsServerIdentity)'
2019-02-19 11:47:02.039 +01:00 [INF] Request finished in 69.949ms 302 
2019-02-19 11:47:02.046 +01:00 [INF] Request starting HTTP/1.1 GET http://localhost:44352/Account/Login?ReturnUrl=%2Fdevice  
2019-02-19 11:47:02.047 +01:00 [INF] Executing endpoint 'StsServerIdentity.Controllers.AccountController.Login (StsServerIdentity)'
2019-02-19 11:47:02.052 +01:00 [INF] Route matched with {action = "Login", controller = "Account"}. Executing action StsServerIdentity.Controllers.AccountController.Login (StsServerIdentity)
2019-02-19 11:47:02.081 +01:00 [INF] Executing action method StsServerIdentity.Controllers.AccountController.Login (StsServerIdentity) with arguments (["/device"]) - Validation state: "Valid"
2019-02-19 11:47:02.087 +01:00 [INF] Executed action method StsServerIdentity.Controllers.AccountController.Login (StsServerIdentity), returned result Microsoft.AspNetCore.Mvc.ViewResult in 6.2855ms.
2019-02-19 11:47:02.090 +01:00 [INF] Executing ViewResult, running view Login.
2019-02-19 11:47:02.426 +01:00 [INF] Executed ViewResult - view Login executed in 338.85990000000004ms.
2019-02-19 11:47:02.426 +01:00 [INF] Executed action StsServerIdentity.Controllers.AccountController.Login (StsServerIdentity) in 374.4075ms
2019-02-19 11:47:02.426 +01:00 [INF] Executed endpoint 'StsServerIdentity.Controllers.AccountController.Login (StsServerIdentity)'
2019-02-19 11:47:02.426 +01:00 [INF] Request finished in 380.5336ms 200 text/html; charset=utf-8
2019-02-19 11:47:02.429 +01:00 [INF] Request starting HTTP/1.1 GET http://localhost:44352/Account/Login?ReturnUrl=%2Fdevice  
2019-02-19 11:47:02.436 +01:00 [INF] Executing endpoint 'StsServerIdentity.Controllers.AccountController.Login (StsServerIdentity)'
2019-02-19 11:47:02.436 +01:00 [INF] Route matched with {action = "Login", controller = "Account"}. Executing action StsServerIdentity.Controllers.AccountController.Login (StsServerIdentity)
2019-02-19 11:47:02.465 +01:00 [INF] Executing action method StsServerIdentity.Controllers.AccountController.Login (StsServerIdentity) with arguments (["/device"]) - Validation state: "Valid"
2019-02-19 11:47:02.465 +01:00 [INF] Request starting HTTP/1.1 GET http://localhost:44352/js/vendor-validation.min.js?v=Ld6X4VUYMOROEbqW0eja-WIzvYYsejBuFJOSJoun1LM  
2019-02-19 11:47:02.465 +01:00 [INF] Executed action method StsServerIdentity.Controllers.AccountController.Login (StsServerIdentity), returned result Microsoft.AspNetCore.Mvc.ViewResult in 0.1149ms.
2019-02-19 11:47:02.465 +01:00 [INF] Executing ViewResult, running view Login.
2019-02-19 11:47:02.469 +01:00 [INF] Executed ViewResult - view Login executed in 3.1898ms.
2019-02-19 11:47:02.469 +01:00 [INF] Executed action StsServerIdentity.Controllers.AccountController.Login (StsServerIdentity) in 32.3558ms
2019-02-19 11:47:02.469 +01:00 [INF] Executed endpoint 'StsServerIdentity.Controllers.AccountController.Login (StsServerIdentity)'
2019-02-19 11:47:02.469 +01:00 [INF] Request finished in 39.6377ms 200 text/html; charset=utf-8
2019-02-19 11:47:02.470 +01:00 [INF] Sending file. Request path: '/js/vendor-validation.min.js'. Physical path: 'C:\git\damienbod\AspNetCoreHybridFlowWithApi\StsServer\wwwroot\js\vendor-validation.min.js'
2019-02-19 11:47:02.470 +01:00 [INF] Request finished in 4.638ms 200 application/javascript
2019-02-19 11:47:04.216 +01:00 [INF] Request starting HTTP/1.1 POST http://localhost:44352/Account/Login?returnurl=%2Fdevice application/x-www-form-urlencoded 252
2019-02-19 11:47:04.230 +01:00 [INF] Executing endpoint 'StsServerIdentity.Controllers.AccountController.Login (StsServerIdentity)'
2019-02-19 11:47:04.236 +01:00 [INF] Route matched with {action = "Login", controller = "Account"}. Executing action StsServerIdentity.Controllers.AccountController.Login (StsServerIdentity)
2019-02-19 11:47:04.286 +01:00 [INF] Executing action method StsServerIdentity.Controllers.AccountController.Login (StsServerIdentity) with arguments (["StsServerIdentity.Models.LoginInputModel"]) - Validation state: "Valid"
2019-02-19 11:47:04.293 +01:00 [INF] Entity Framework Core 2.2.2-servicing-10034 initialized 'ApplicationDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer' with options: None
2019-02-19 11:47:04.368 +01:00 [INF] Executed DbCommand (41ms) [Parameters=[@__normalizedUserName_0='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[Id], [u].[AccessFailedCount], [u].[ConcurrencyStamp], [u].[DataEventRecordsRole], [u].[Email], [u].[EmailConfirmed], [u].[IsAdmin], [u].[LockoutEnabled], [u].[LockoutEnd], [u].[NormalizedEmail], [u].[NormalizedUserName], [u].[PasswordHash], [u].[PhoneNumber], [u].[PhoneNumberConfirmed], [u].[SecuredFilesRole], [u].[SecurityStamp], [u].[TwoFactorEnabled], [u].[UserName]
FROM [AspNetUsers] AS [u]
WHERE [u].[NormalizedUserName] = @__normalizedUserName_0
2019-02-19 11:47:04.456 +01:00 [INF] Executed DbCommand (39ms) [Parameters=[@__user_Id_0='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT [uc].[Id], [uc].[ClaimType], [uc].[ClaimValue], [uc].[UserId]
FROM [AspNetUserClaims] AS [uc]
WHERE [uc].[UserId] = @__user_Id_0
2019-02-19 11:47:04.489 +01:00 [INF] Executed DbCommand (32ms) [Parameters=[@__userId_0='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT [role].[Name]
FROM [AspNetUserRoles] AS [userRole]
INNER JOIN [AspNetRoles] AS [role] ON [userRole].[RoleId] = [role].[Id]
WHERE [userRole].[UserId] = @__userId_0
2019-02-19 11:47:04.507 +01:00 [INF] AuthenticationScheme: Identity.Application signed in.
2019-02-19 11:47:04.512 +01:00 [INF] User logged in.
2019-02-19 11:47:04.514 +01:00 [INF] Executed action method StsServerIdentity.Controllers.AccountController.Login (StsServerIdentity), returned result Microsoft.AspNetCore.Mvc.RedirectResult in 227.77630000000002ms.
2019-02-19 11:47:04.521 +01:00 [INF] Executing RedirectResult, redirecting to /device.
2019-02-19 11:47:04.523 +01:00 [INF] Executed action StsServerIdentity.Controllers.AccountController.Login (StsServerIdentity) in 287.1945ms
2019-02-19 11:47:04.524 +01:00 [INF] Executed endpoint 'StsServerIdentity.Controllers.AccountController.Login (StsServerIdentity)'
2019-02-19 11:47:04.529 +01:00 [INF] Request finished in 312.8352ms 302 
2019-02-19 11:47:04.534 +01:00 [INF] Request starting HTTP/1.1 GET http://localhost:44352/device  
2019-02-19 11:47:04.534 +01:00 [INF] Executing endpoint 'StsServerIdentity.Controllers.DeviceController.Index (StsServerIdentity)'
2019-02-19 11:47:04.534 +01:00 [INF] Route matched with {action = "Index", controller = "Device"}. Executing action StsServerIdentity.Controllers.DeviceController.Index (StsServerIdentity)
2019-02-19 11:47:04.535 +01:00 [INF] Authorization was successful.
2019-02-19 11:47:04.564 +01:00 [INF] Executing action method StsServerIdentity.Controllers.DeviceController.Index (StsServerIdentity) with arguments ([""]) - Validation state: "Valid"
2019-02-19 11:47:04.565 +01:00 [INF] Executed action method StsServerIdentity.Controllers.DeviceController.Index (StsServerIdentity), returned result Microsoft.AspNetCore.Mvc.ViewResult in 1.1936ms.
2019-02-19 11:47:04.568 +01:00 [INF] Executing ViewResult, running view UserCodeCapture.
2019-02-19 11:47:04.575 +01:00 [INF] Executed ViewResult - view UserCodeCapture executed in 9.9224ms.
2019-02-19 11:47:04.576 +01:00 [INF] Executed action StsServerIdentity.Controllers.DeviceController.Index (StsServerIdentity) in 41.0521ms
2019-02-19 11:47:04.576 +01:00 [INF] Executed endpoint 'StsServerIdentity.Controllers.DeviceController.Index (StsServerIdentity)'
2019-02-19 11:47:04.576 +01:00 [INF] Request finished in 42.0969ms 200 text/html; charset=utf-8
2019-02-19 11:47:12.106 +01:00 [INF] Request starting HTTP/1.1 POST http://localhost:44352/Device/UserCodeCapture application/x-www-form-urlencoded 244
2019-02-19 11:47:12.108 +01:00 [INF] Executing endpoint 'StsServerIdentity.Controllers.DeviceController.UserCodeCapture (StsServerIdentity)'
2019-02-19 11:47:12.115 +01:00 [INF] Route matched with {action = "UserCodeCapture", controller = "Device"}. Executing action StsServerIdentity.Controllers.DeviceController.UserCodeCapture (StsServerIdentity)
2019-02-19 11:47:12.115 +01:00 [INF] Authorization was successful.
2019-02-19 11:47:12.149 +01:00 [INF] Executing action method StsServerIdentity.Controllers.DeviceController.UserCodeCapture (StsServerIdentity) with arguments (["411566886"]) - Validation state: "Valid"
2019-02-19 11:47:12.156 +01:00 [INF] Executed action method StsServerIdentity.Controllers.DeviceController.UserCodeCapture (StsServerIdentity), returned result Microsoft.AspNetCore.Mvc.ViewResult in 7.022ms.
2019-02-19 11:47:12.160 +01:00 [INF] Executing ViewResult, running view UserCodeConfirmation.
2019-02-19 11:47:12.181 +01:00 [INF] Executed ViewResult - view UserCodeConfirmation executed in 24.7713ms.
2019-02-19 11:47:12.181 +01:00 [INF] Executed action StsServerIdentity.Controllers.DeviceController.UserCodeCapture (StsServerIdentity) in 65.7076ms
2019-02-19 11:47:12.181 +01:00 [INF] Executed endpoint 'StsServerIdentity.Controllers.DeviceController.UserCodeCapture (StsServerIdentity)'
2019-02-19 11:47:12.181 +01:00 [INF] Request finished in 74.606ms 200 text/html; charset=utf-8
2019-02-19 11:47:20.062 +01:00 [INF] Request starting HTTP/1.1 POST http://localhost:44352/Device/Callback application/x-www-form-urlencoded 367
2019-02-19 11:47:20.064 +01:00 [INF] Executing endpoint 'StsServerIdentity.Controllers.DeviceController.Callback (StsServerIdentity)'
2019-02-19 11:47:20.082 +01:00 [INF] Route matched with {action = "Callback", controller = "Device"}. Executing action StsServerIdentity.Controllers.DeviceController.Callback (StsServerIdentity)
2019-02-19 11:47:20.082 +01:00 [INF] Authorization was successful.
2019-02-19 11:47:20.117 +01:00 [INF] Executing action method StsServerIdentity.Controllers.DeviceController.Callback (StsServerIdentity) with arguments (["StsServerIdentity.Models.DeviceAuthorizationInputModel"]) - Validation state: "Valid"
2019-02-19 11:47:20.126 +01:00 [INF] Executed action method StsServerIdentity.Controllers.DeviceController.Callback (StsServerIdentity), returned result Microsoft.AspNetCore.Mvc.ViewResult in 8.7049ms.
2019-02-19 11:47:20.131 +01:00 [INF] Executing ViewResult, running view Success.
2019-02-19 11:47:20.135 +01:00 [INF] Executed ViewResult - view Success executed in 8.0300000000000011ms.
2019-02-19 11:47:20.135 +01:00 [INF] Executed action StsServerIdentity.Controllers.DeviceController.Callback (StsServerIdentity) in 52.822700000000005ms
2019-02-19 11:47:20.135 +01:00 [INF] Executed endpoint 'StsServerIdentity.Controllers.DeviceController.Callback (StsServerIdentity)'
2019-02-19 11:47:20.135 +01:00 [INF] Request finished in 73.6101ms 200 text/html; charset=utf-8
2019-02-19 11:47:29.783 +01:00 [INF] Request starting HTTP/1.1 GET http://localhost:44352/.well-known/openid-configuration  
2019-02-19 11:47:29.784 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-02-19 11:47:29.784 +01:00 [INF] Request finished in 0.9755ms 200 application/json; charset=UTF-8
2019-02-19 11:47:29.787 +01:00 [INF] Request starting HTTP/1.1 GET http://localhost:44352/.well-known/openid-configuration/jwks  
2019-02-19 11:47:29.787 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2019-02-19 11:47:29.788 +01:00 [INF] Request finished in 1.1423ms 200 application/jwk-set+json; charset=UTF-8
2019-02-19 11:47:29.815 +01:00 [INF] Request starting HTTP/1.1 POST http://localhost:44352/connect/token application/x-www-form-urlencoded 172
2019-02-19 11:47:29.819 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.TokenEndpoint for /connect/token
2019-02-19 11:47:29.848 +01:00 [INF] Entity Framework Core 2.2.2-servicing-10034 initialized 'ApplicationDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer' with options: None
2019-02-19 11:47:29.883 +01:00 [INF] Executed DbCommand (34ms) [Parameters=[@__get_Item_0='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [e].[Id], [e].[AccessFailedCount], [e].[ConcurrencyStamp], [e].[DataEventRecordsRole], [e].[Email], [e].[EmailConfirmed], [e].[IsAdmin], [e].[LockoutEnabled], [e].[LockoutEnd], [e].[NormalizedEmail], [e].[NormalizedUserName], [e].[PasswordHash], [e].[PhoneNumber], [e].[PhoneNumberConfirmed], [e].[SecuredFilesRole], [e].[SecurityStamp], [e].[TwoFactorEnabled], [e].[UserName]
FROM [AspNetUsers] AS [e]
WHERE [e].[Id] = @__get_Item_0
2019-02-19 11:47:29.892 +01:00 [INF] Token request validation success
{"ClientId":"deviceFlowWebClient","ClientName":"Device Flow Client","GrantType":"urn:ietf:params:oauth:grant-type:device_code","Scopes":null,"AuthorizationCode":null,"RefreshToken":null,"UserName":null,"AuthenticationContextReferenceClasses":null,"Tenant":null,"IdP":null,"Raw":{"device_code":"***REDACTED***","grant_type":"urn:ietf:params:oauth:grant-type:device_code","client_id":"deviceFlowWebClient"},"$type":"TokenRequestValidationLog"}
2019-02-19 11:47:29.946 +01:00 [INF] Executed DbCommand (26ms) [Parameters=[@__user_Id_0='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT [uc].[Id], [uc].[ClaimType], [uc].[ClaimValue], [uc].[UserId]
FROM [AspNetUserClaims] AS [uc]
WHERE [uc].[UserId] = @__user_Id_0
2019-02-19 11:47:29.972 +01:00 [INF] Executed DbCommand (25ms) [Parameters=[@__userId_0='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT [role].[Name]
FROM [AspNetUserRoles] AS [userRole]
INNER JOIN [AspNetRoles] AS [role] ON [userRole].[RoleId] = [role].[Id]
WHERE [userRole].[UserId] = @__userId_0
2019-02-19 11:47:30.059 +01:00 [INF] Request finished in 243.9261ms 200 application/json; charset=UTF-8
2019-02-19 11:50:14.819 +01:00 [INF] User profile is available. Using 'C:\Users\stduser\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2019-02-19 11:50:15.199 +01:00 [INF] Starting IdentityServer4 version 2.3.2.0
2019-02-19 11:50:15.224 +01:00 [INF] You are using the in-memory version of the persisted grant store. This will store consent decisions, authorization codes, refresh and reference tokens in memory only. If you are using any of those features in production, you want to switch to a different store implementation.
2019-02-19 11:50:15.245 +01:00 [INF] Using the default authentication scheme Identity.Application for IdentityServer
2019-02-19 11:50:16.711 +01:00 [INF] Request starting HTTP/1.1 GET http://localhost:44352/  
2019-02-19 11:50:16.711 +01:00 [INF] Request starting HTTP/1.1 DEBUG http://localhost:44352/  0
2019-02-19 11:50:16.711 +01:00 [INF] Request starting HTTP/1.1 GET http://localhost:44352/.well-known/openid-configuration  
2019-02-19 11:50:16.748 +01:00 [INF] Request finished in 29.2082ms 200 
2019-02-19 11:50:16.973 +01:00 [INF] Executing endpoint 'StsServerIdentity.Controllers.HomeController.Index (StsServerIdentity)'
2019-02-19 11:50:17.002 +01:00 [INF] Route matched with {action = "Index", controller = "Home"}. Executing action StsServerIdentity.Controllers.HomeController.Index (StsServerIdentity)
2019-02-19 11:50:17.162 +01:00 [INF] Executing action method StsServerIdentity.Controllers.HomeController.Index (StsServerIdentity) - Validation state: "Valid"
2019-02-19 11:50:17.184 +01:00 [INF] Executed action method StsServerIdentity.Controllers.HomeController.Index (StsServerIdentity), returned result Microsoft.AspNetCore.Mvc.ViewResult in 1.3226ms.
2019-02-19 11:50:17.468 +01:00 [INF] Executing ViewResult, running view Index.
2019-02-19 11:50:17.568 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-02-19 11:50:17.956 +01:00 [INF] Request finished in 1247.4932ms 200 application/json; charset=UTF-8
2019-02-19 11:50:18.256 +01:00 [INF] Request starting HTTP/1.1 GET http://localhost:44352/.well-known/openid-configuration/jwks  
2019-02-19 11:50:18.257 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2019-02-19 11:50:18.335 +01:00 [INF] Executed ViewResult - view Index executed in 956.1571ms.
2019-02-19 11:50:18.336 +01:00 [INF] Executed action StsServerIdentity.Controllers.HomeController.Index (StsServerIdentity) in 1333.0223ms
2019-02-19 11:50:18.336 +01:00 [INF] Executed endpoint 'StsServerIdentity.Controllers.HomeController.Index (StsServerIdentity)'
2019-02-19 11:50:18.340 +01:00 [INF] Request finished in 1632.0423ms 200 text/html; charset=utf-8
2019-02-19 11:50:18.340 +01:00 [INF] Request finished in 84.6937ms 200 application/jwk-set+json; charset=UTF-8
2019-02-19 11:50:18.378 +01:00 [INF] Request starting HTTP/1.1 GET http://localhost:44352/css/site.min.css?v=9n42HB2zuqXKDsr8sMaXB5eFvO87SuAf1CjiV4cv1Fg  
2019-02-19 11:50:18.380 +01:00 [INF] Request starting HTTP/1.1 GET http://localhost:44352/css/vendor.min.css?v=RtIwopEx0osLqdXB1F1QPDFWzutpmmdukcoICaRWUFI  
2019-02-19 11:50:18.381 +01:00 [INF] Request starting HTTP/1.1 GET http://localhost:44352/js/vendor.min.js?v=yg3700ylkpEbw8o9sR1SsYLHNI0v7pw6lI42YH1q40o  
2019-02-19 11:50:18.386 +01:00 [INF] Request starting HTTP/1.1 GET http://localhost:44352/js/site.min.js?v=47DEQpj8HBSa-_TImW-5JCeuQeRkm5NMpJWZG3hSuFU  
2019-02-19 11:50:18.391 +01:00 [INF] The file /js/vendor.min.js was not modified
2019-02-19 11:50:18.391 +01:00 [INF] The file /css/vendor.min.css was not modified
2019-02-19 11:50:18.391 +01:00 [INF] The file /js/site.min.js was not modified
2019-02-19 11:50:18.391 +01:00 [INF] The file /css/site.min.css was not modified
2019-02-19 11:50:18.397 +01:00 [INF] Request finished in 16.5027ms 304 text/css
2019-02-19 11:50:18.397 +01:00 [INF] Request finished in 11.1573ms 304 application/javascript
2019-02-19 11:50:18.397 +01:00 [INF] Request finished in 15.4598ms 304 application/javascript
2019-02-19 11:50:18.397 +01:00 [INF] Request finished in 19.325ms 304 text/css
2019-02-19 11:50:18.466 +01:00 [INF] Request starting HTTP/1.1 GET http://localhost:44352/connect/authorize?client_id=hybridclient&redirect_uri=https%3A%2F%2Flocalhost%3A44329%2Fsignin-oidc&response_type=code%20id_token&scope=openid%20profile%20scope_used_for_hybrid_flow%20offline_access&response_mode=form_post&nonce=636861702183944005.MzM0MzMwZWQtM2JmMy00NWM1LWJlYTYtN2QwMTZiZTM2YWY1MDRmZGE3ZWMtODNhZS00MjgyLWEzN2QtMjQ5MWU0ZjljOGI2&state=CfDJ8CGpEylrt0pIt6txpyTWMbQ_fM5YtuRnekyuEKoQdaspLdcYYm3VbxH8udWaUsJ3ixNPDXPl0XFAdwNMB_fECR4tEfyOAY23Z2crNqHrbmugRJVXxrovoRhKndu2Jjx5eZDT3wRrcfjrzttI-rIfxnFHat6qO6CawpNEcxWoY9NVAF7dZjcOoEZbzJO3vt9u79zTi12sVW_8MFdWFwh4Lp-LurzRgonmCDR7QYKmpj9UGRKTi3WqZFpHi5I6zsZhHhyY_oDWUr066MZu5Dgw0djdoXWfSFlFkLEDbaSiCSlM53Q85P5f3ELyXB8Lym1L_GQxA1-jymLMRoWucimGj3o&x-client-SKU=ID_NETSTANDARD2_0&x-client-ver=5.3.0.0  
2019-02-19 11:50:18.471 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2019-02-19 11:50:18.635 +01:00 [INF] ValidatedAuthorizeRequest
{"ClientId":"hybridclient","ClientName":"hybridclient","RedirectUri":"https://localhost:44329/signin-oidc","AllowedRedirectUris":["https://localhost:44329/signin-oidc"],"SubjectId":"anonymous","ResponseType":"code id_token","ResponseMode":"form_post","GrantType":"hybrid","RequestedScopes":"openid profile scope_used_for_hybrid_flow offline_access","State":"CfDJ8CGpEylrt0pIt6txpyTWMbQ_fM5YtuRnekyuEKoQdaspLdcYYm3VbxH8udWaUsJ3ixNPDXPl0XFAdwNMB_fECR4tEfyOAY23Z2crNqHrbmugRJVXxrovoRhKndu2Jjx5eZDT3wRrcfjrzttI-rIfxnFHat6qO6CawpNEcxWoY9NVAF7dZjcOoEZbzJO3vt9u79zTi12sVW_8MFdWFwh4Lp-LurzRgonmCDR7QYKmpj9UGRKTi3WqZFpHi5I6zsZhHhyY_oDWUr066MZu5Dgw0djdoXWfSFlFkLEDbaSiCSlM53Q85P5f3ELyXB8Lym1L_GQxA1-jymLMRoWucimGj3o","UiLocales":null,"Nonce":"636861702183944005.MzM0MzMwZWQtM2JmMy00NWM1LWJlYTYtN2QwMTZiZTM2YWY1MDRmZGE3ZWMtODNhZS00MjgyLWEzN2QtMjQ5MWU0ZjljOGI2","AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":null,"Raw":{"client_id":"hybridclient","redirect_uri":"https://localhost:44329/signin-oidc","response_type":"code id_token","scope":"openid profile scope_used_for_hybrid_flow offline_access","response_mode":"form_post","nonce":"636861702183944005.MzM0MzMwZWQtM2JmMy00NWM1LWJlYTYtN2QwMTZiZTM2YWY1MDRmZGE3ZWMtODNhZS00MjgyLWEzN2QtMjQ5MWU0ZjljOGI2","state":"CfDJ8CGpEylrt0pIt6txpyTWMbQ_fM5YtuRnekyuEKoQdaspLdcYYm3VbxH8udWaUsJ3ixNPDXPl0XFAdwNMB_fECR4tEfyOAY23Z2crNqHrbmugRJVXxrovoRhKndu2Jjx5eZDT3wRrcfjrzttI-rIfxnFHat6qO6CawpNEcxWoY9NVAF7dZjcOoEZbzJO3vt9u79zTi12sVW_8MFdWFwh4Lp-LurzRgonmCDR7QYKmpj9UGRKTi3WqZFpHi5I6zsZhHhyY_oDWUr066MZu5Dgw0djdoXWfSFlFkLEDbaSiCSlM53Q85P5f3ELyXB8Lym1L_GQxA1-jymLMRoWucimGj3o","x-client-SKU":"ID_NETSTANDARD2_0","x-client-ver":"5.3.0.0"},"$type":"AuthorizeRequestValidationLog"}
2019-02-19 11:50:18.665 +01:00 [INF] Showing login: User is not authenticated
2019-02-19 11:50:18.670 +01:00 [INF] Request finished in 204.6641ms 302 
2019-02-19 11:50:18.677 +01:00 [INF] Request starting HTTP/1.1 GET http://localhost:44352/Account/Login?ReturnUrl=%2Fconnect%2Fauthorize%2Fcallback%3Fclient_id%3Dhybridclient%26redirect_uri%3Dhttps%253A%252F%252Flocalhost%253A44329%252Fsignin-oidc%26response_type%3Dcode%2520id_token%26scope%3Dopenid%2520profile%2520scope_used_for_hybrid_flow%2520offline_access%26response_mode%3Dform_post%26nonce%3D636861702183944005.MzM0MzMwZWQtM2JmMy00NWM1LWJlYTYtN2QwMTZiZTM2YWY1MDRmZGE3ZWMtODNhZS00MjgyLWEzN2QtMjQ5MWU0ZjljOGI2%26state%3DCfDJ8CGpEylrt0pIt6txpyTWMbQ_fM5YtuRnekyuEKoQdaspLdcYYm3VbxH8udWaUsJ3ixNPDXPl0XFAdwNMB_fECR4tEfyOAY23Z2crNqHrbmugRJVXxrovoRhKndu2Jjx5eZDT3wRrcfjrzttI-rIfxnFHat6qO6CawpNEcxWoY9NVAF7dZjcOoEZbzJO3vt9u79zTi12sVW_8MFdWFwh4Lp-LurzRgonmCDR7QYKmpj9UGRKTi3WqZFpHi5I6zsZhHhyY_oDWUr066MZu5Dgw0djdoXWfSFlFkLEDbaSiCSlM53Q85P5f3ELyXB8Lym1L_GQxA1-jymLMRoWucimGj3o%26x-client-SKU%3DID_NETSTANDARD2_0%26x-client-ver%3D5.3.0.0  
2019-02-19 11:50:18.697 +01:00 [INF] Executing endpoint 'StsServerIdentity.Controllers.AccountController.Login (StsServerIdentity)'
2019-02-19 11:50:18.724 +01:00 [INF] Route matched with {action = "Login", controller = "Account"}. Executing action StsServerIdentity.Controllers.AccountController.Login (StsServerIdentity)
2019-02-19 11:50:18.780 +01:00 [INF] Executing action method StsServerIdentity.Controllers.AccountController.Login (StsServerIdentity) with arguments (["/connect/authorize/callback?client_id=hybridclient&redirect_uri=https%3A%2F%2Flocalhost%3A44329%2Fsignin-oidc&response_type=code%20id_token&scope=openid%20profile%20scope_used_for_hybrid_flow%20offline_access&response_mode=form_post&nonce=636861702183944005.MzM0MzMwZWQtM2JmMy00NWM1LWJlYTYtN2QwMTZiZTM2YWY1MDRmZGE3ZWMtODNhZS00MjgyLWEzN2QtMjQ5MWU0ZjljOGI2&state=CfDJ8CGpEylrt0pIt6txpyTWMbQ_fM5YtuRnekyuEKoQdaspLdcYYm3VbxH8udWaUsJ3ixNPDXPl0XFAdwNMB_fECR4tEfyOAY23Z2crNqHrbmugRJVXxrovoRhKndu2Jjx5eZDT3wRrcfjrzttI-rIfxnFHat6qO6CawpNEcxWoY9NVAF7dZjcOoEZbzJO3vt9u79zTi12sVW_8MFdWFwh4Lp-LurzRgonmCDR7QYKmpj9UGRKTi3WqZFpHi5I6zsZhHhyY_oDWUr066MZu5Dgw0djdoXWfSFlFkLEDbaSiCSlM53Q85P5f3ELyXB8Lym1L_GQxA1-jymLMRoWucimGj3o&x-client-SKU=ID_NETSTANDARD2_0&x-client-ver=5.3.0.0"]) - Validation state: "Valid"
2019-02-19 11:50:18.799 +01:00 [INF] Executed action method StsServerIdentity.Controllers.AccountController.Login (StsServerIdentity), returned result Microsoft.AspNetCore.Mvc.ViewResult in 18.4475ms.
2019-02-19 11:50:18.803 +01:00 [INF] Executing ViewResult, running view Login.
2019-02-19 11:50:18.861 +01:00 [INF] Executed ViewResult - view Login executed in 62.0576ms.
2019-02-19 11:50:18.862 +01:00 [INF] Executed action StsServerIdentity.Controllers.AccountController.Login (StsServerIdentity) in 137.0394ms
2019-02-19 11:50:18.862 +01:00 [INF] Executed endpoint 'StsServerIdentity.Controllers.AccountController.Login (StsServerIdentity)'
2019-02-19 11:50:18.862 +01:00 [INF] Request finished in 184.7426ms 200 text/html; charset=utf-8
2019-02-19 11:50:19.972 +01:00 [INF] Request starting HTTP/1.1 GET http://localhost:44352/.well-known/openid-configuration  
2019-02-19 11:50:19.973 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-02-19 11:50:19.973 +01:00 [INF] Request finished in 1.3313ms 200 application/json; charset=UTF-8
2019-02-19 11:50:20.006 +01:00 [INF] Request starting HTTP/1.1 GET http://localhost:44352/.well-known/openid-configuration/jwks  
2019-02-19 11:50:20.006 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2019-02-19 11:50:20.007 +01:00 [INF] Request finished in 1.3527ms 200 application/jwk-set+json; charset=UTF-8
2019-02-19 11:50:20.128 +01:00 [INF] Request starting HTTP/1.1 POST http://localhost:44352/connect/deviceauthorization application/x-www-form-urlencoded 56
2019-02-19 11:50:20.131 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DeviceAuthorizationEndpoint for /connect/deviceauthorization
2019-02-19 11:50:20.204 +01:00 [INF] Request finished in 75.8375ms 200 application/json; charset=UTF-8
2019-02-19 11:50:26.421 +01:00 [INF] Request starting HTTP/1.1 GET http://localhost:44352/device  
2019-02-19 11:50:26.426 +01:00 [INF] Executing endpoint 'StsServerIdentity.Controllers.DeviceController.Index (StsServerIdentity)'
2019-02-19 11:50:26.444 +01:00 [INF] Route matched with {action = "Index", controller = "Device"}. Executing action StsServerIdentity.Controllers.DeviceController.Index (StsServerIdentity)
2019-02-19 11:50:26.456 +01:00 [INF] Authorization failed.
2019-02-19 11:50:26.457 +01:00 [INF] Authorization failed for the request at filter 'Microsoft.AspNetCore.Mvc.Authorization.AuthorizeFilter'.
2019-02-19 11:50:26.462 +01:00 [INF] Executing ChallengeResult with authentication schemes ([]).
2019-02-19 11:50:26.468 +01:00 [INF] AuthenticationScheme: Identity.Application was challenged.
2019-02-19 11:50:26.468 +01:00 [INF] Executed action StsServerIdentity.Controllers.DeviceController.Index (StsServerIdentity) in 24.372300000000003ms
2019-02-19 11:50:26.468 +01:00 [INF] Executed endpoint 'StsServerIdentity.Controllers.DeviceController.Index (StsServerIdentity)'
2019-02-19 11:50:26.468 +01:00 [INF] Request finished in 47.1219ms 302 
2019-02-19 11:50:26.473 +01:00 [INF] Request starting HTTP/1.1 GET http://localhost:44352/Account/Login?ReturnUrl=%2Fdevice  
2019-02-19 11:50:26.482 +01:00 [INF] Executing endpoint 'StsServerIdentity.Controllers.AccountController.Login (StsServerIdentity)'
2019-02-19 11:50:26.482 +01:00 [INF] Route matched with {action = "Login", controller = "Account"}. Executing action StsServerIdentity.Controllers.AccountController.Login (StsServerIdentity)
2019-02-19 11:50:26.514 +01:00 [INF] Executing action method StsServerIdentity.Controllers.AccountController.Login (StsServerIdentity) with arguments (["/device"]) - Validation state: "Valid"
2019-02-19 11:50:26.515 +01:00 [INF] Executed action method StsServerIdentity.Controllers.AccountController.Login (StsServerIdentity), returned result Microsoft.AspNetCore.Mvc.ViewResult in 0.41400000000000003ms.
2019-02-19 11:50:26.515 +01:00 [INF] Executing ViewResult, running view Login.
2019-02-19 11:50:26.518 +01:00 [INF] Executed ViewResult - view Login executed in 2.8576ms.
2019-02-19 11:50:26.518 +01:00 [INF] Executed action StsServerIdentity.Controllers.AccountController.Login (StsServerIdentity) in 35.2528ms
2019-02-19 11:50:26.518 +01:00 [INF] Executed endpoint 'StsServerIdentity.Controllers.AccountController.Login (StsServerIdentity)'
2019-02-19 11:50:26.518 +01:00 [INF] Request finished in 44.6394ms 200 text/html; charset=utf-8
2019-02-19 11:50:26.949 +01:00 [INF] Request starting HTTP/1.1 GET http://localhost:44352/Account/Login?ReturnUrl=%2Fdevice  
2019-02-19 11:50:26.950 +01:00 [INF] Executing endpoint 'StsServerIdentity.Controllers.AccountController.Login (StsServerIdentity)'
2019-02-19 11:50:26.951 +01:00 [INF] Route matched with {action = "Login", controller = "Account"}. Executing action StsServerIdentity.Controllers.AccountController.Login (StsServerIdentity)
2019-02-19 11:50:27.040 +01:00 [INF] Executing action method StsServerIdentity.Controllers.AccountController.Login (StsServerIdentity) with arguments (["/device"]) - Validation state: "Valid"
2019-02-19 11:50:27.041 +01:00 [INF] Executed action method StsServerIdentity.Controllers.AccountController.Login (StsServerIdentity), returned result Microsoft.AspNetCore.Mvc.ViewResult in 0.0649ms.
2019-02-19 11:50:27.041 +01:00 [INF] Executing ViewResult, running view Login.
2019-02-19 11:50:27.046 +01:00 [INF] Executed ViewResult - view Login executed in 5.053ms.
2019-02-19 11:50:27.046 +01:00 [INF] Executed action StsServerIdentity.Controllers.AccountController.Login (StsServerIdentity) in 95.3512ms
2019-02-19 11:50:27.046 +01:00 [INF] Executed endpoint 'StsServerIdentity.Controllers.AccountController.Login (StsServerIdentity)'
2019-02-19 11:50:27.046 +01:00 [INF] Request finished in 97.2605ms 200 text/html; charset=utf-8
2019-02-19 11:50:29.098 +01:00 [INF] Request starting HTTP/1.1 POST http://localhost:44352/Account/Login?returnurl=%2Fdevice application/x-www-form-urlencoded 252
2019-02-19 11:50:29.111 +01:00 [INF] Executing endpoint 'StsServerIdentity.Controllers.AccountController.Login (StsServerIdentity)'
2019-02-19 11:50:29.118 +01:00 [INF] Route matched with {action = "Login", controller = "Account"}. Executing action StsServerIdentity.Controllers.AccountController.Login (StsServerIdentity)
2019-02-19 11:50:29.182 +01:00 [INF] Executing action method StsServerIdentity.Controllers.AccountController.Login (StsServerIdentity) with arguments (["StsServerIdentity.Models.LoginInputModel"]) - Validation state: "Valid"
2019-02-19 11:50:29.753 +01:00 [INF] Entity Framework Core 2.2.2-servicing-10034 initialized 'ApplicationDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer' with options: None
2019-02-19 11:50:30.268 +01:00 [INF] Executed DbCommand (69ms) [Parameters=[@__normalizedUserName_0='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[Id], [u].[AccessFailedCount], [u].[ConcurrencyStamp], [u].[DataEventRecordsRole], [u].[Email], [u].[EmailConfirmed], [u].[IsAdmin], [u].[LockoutEnabled], [u].[LockoutEnd], [u].[NormalizedEmail], [u].[NormalizedUserName], [u].[PasswordHash], [u].[PhoneNumber], [u].[PhoneNumberConfirmed], [u].[SecuredFilesRole], [u].[SecurityStamp], [u].[TwoFactorEnabled], [u].[UserName]
FROM [AspNetUsers] AS [u]
WHERE [u].[NormalizedUserName] = @__normalizedUserName_0
2019-02-19 11:50:30.619 +01:00 [INF] Executed DbCommand (61ms) [Parameters=[@__user_Id_0='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT [uc].[Id], [uc].[ClaimType], [uc].[ClaimValue], [uc].[UserId]
FROM [AspNetUserClaims] AS [uc]
WHERE [uc].[UserId] = @__user_Id_0
2019-02-19 11:50:30.689 +01:00 [INF] Executed DbCommand (19ms) [Parameters=[@__userId_0='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT [role].[Name]
FROM [AspNetUserRoles] AS [userRole]
INNER JOIN [AspNetRoles] AS [role] ON [userRole].[RoleId] = [role].[Id]
WHERE [userRole].[UserId] = @__userId_0
2019-02-19 11:50:30.719 +01:00 [INF] AuthenticationScheme: Identity.Application signed in.
2019-02-19 11:50:30.722 +01:00 [INF] User logged in.
2019-02-19 11:50:30.725 +01:00 [INF] Executed action method StsServerIdentity.Controllers.AccountController.Login (StsServerIdentity), returned result Microsoft.AspNetCore.Mvc.RedirectResult in 1542.0734ms.
2019-02-19 11:50:30.730 +01:00 [INF] Executing RedirectResult, redirecting to /device.
2019-02-19 11:50:30.732 +01:00 [INF] Executed action StsServerIdentity.Controllers.AccountController.Login (StsServerIdentity) in 1613.8086ms
2019-02-19 11:50:30.734 +01:00 [INF] Executed endpoint 'StsServerIdentity.Controllers.AccountController.Login (StsServerIdentity)'
2019-02-19 11:50:30.747 +01:00 [INF] Request finished in 1648.9335ms 302 
2019-02-19 11:50:30.749 +01:00 [INF] Request starting HTTP/1.1 GET http://localhost:44352/device  
2019-02-19 11:50:30.756 +01:00 [INF] Executing endpoint 'StsServerIdentity.Controllers.DeviceController.Index (StsServerIdentity)'
2019-02-19 11:50:30.756 +01:00 [INF] Route matched with {action = "Index", controller = "Device"}. Executing action StsServerIdentity.Controllers.DeviceController.Index (StsServerIdentity)
2019-02-19 11:50:30.756 +01:00 [INF] Authorization was successful.
2019-02-19 11:50:30.780 +01:00 [INF] Executing action method StsServerIdentity.Controllers.DeviceController.Index (StsServerIdentity) with arguments ([""]) - Validation state: "Valid"
2019-02-19 11:50:30.781 +01:00 [INF] Executed action method StsServerIdentity.Controllers.DeviceController.Index (StsServerIdentity), returned result Microsoft.AspNetCore.Mvc.ViewResult in 1.4453ms.
2019-02-19 11:50:30.784 +01:00 [INF] Executing ViewResult, running view UserCodeCapture.
2019-02-19 11:50:30.792 +01:00 [INF] Executed ViewResult - view UserCodeCapture executed in 11.1898ms.
2019-02-19 11:50:30.793 +01:00 [INF] Executed action StsServerIdentity.Controllers.DeviceController.Index (StsServerIdentity) in 36.738800000000005ms
2019-02-19 11:50:30.793 +01:00 [INF] Executed endpoint 'StsServerIdentity.Controllers.DeviceController.Index (StsServerIdentity)'
2019-02-19 11:50:30.793 +01:00 [INF] Request finished in 43.2775ms 200 text/html; charset=utf-8
2019-02-19 11:50:38.352 +01:00 [INF] Request starting HTTP/1.1 POST http://localhost:44352/Device/UserCodeCapture application/x-www-form-urlencoded 244
2019-02-19 11:50:38.354 +01:00 [INF] Executing endpoint 'StsServerIdentity.Controllers.DeviceController.UserCodeCapture (StsServerIdentity)'
2019-02-19 11:50:38.361 +01:00 [INF] Route matched with {action = "UserCodeCapture", controller = "Device"}. Executing action StsServerIdentity.Controllers.DeviceController.UserCodeCapture (StsServerIdentity)
2019-02-19 11:50:38.361 +01:00 [INF] Authorization was successful.
2019-02-19 11:50:38.397 +01:00 [INF] Executing action method StsServerIdentity.Controllers.DeviceController.UserCodeCapture (StsServerIdentity) with arguments (["898252753"]) - Validation state: "Valid"
2019-02-19 11:50:38.408 +01:00 [INF] Executed action method StsServerIdentity.Controllers.DeviceController.UserCodeCapture (StsServerIdentity), returned result Microsoft.AspNetCore.Mvc.ViewResult in 10.279200000000001ms.
2019-02-19 11:50:38.413 +01:00 [INF] Executing ViewResult, running view UserCodeConfirmation.
2019-02-19 11:50:38.448 +01:00 [INF] Executed ViewResult - view UserCodeConfirmation executed in 40.2879ms.
2019-02-19 11:50:38.448 +01:00 [INF] Executed action StsServerIdentity.Controllers.DeviceController.UserCodeCapture (StsServerIdentity) in 87.216400000000007ms
2019-02-19 11:50:38.448 +01:00 [INF] Executed endpoint 'StsServerIdentity.Controllers.DeviceController.UserCodeCapture (StsServerIdentity)'
2019-02-19 11:50:38.449 +01:00 [INF] Request finished in 96.7204ms 200 text/html; charset=utf-8
2019-02-19 11:50:39.923 +01:00 [INF] Request starting HTTP/1.1 POST http://localhost:44352/Device/Callback application/x-www-form-urlencoded 367
2019-02-19 11:50:39.935 +01:00 [INF] Executing endpoint 'StsServerIdentity.Controllers.DeviceController.Callback (StsServerIdentity)'
2019-02-19 11:50:39.958 +01:00 [INF] Route matched with {action = "Callback", controller = "Device"}. Executing action StsServerIdentity.Controllers.DeviceController.Callback (StsServerIdentity)
2019-02-19 11:50:39.959 +01:00 [INF] Authorization was successful.
2019-02-19 11:50:40.085 +01:00 [INF] Executing action method StsServerIdentity.Controllers.DeviceController.Callback (StsServerIdentity) with arguments (["StsServerIdentity.Models.DeviceAuthorizationInputModel"]) - Validation state: "Valid"
2019-02-19 11:50:40.120 +01:00 [INF] Executed action method StsServerIdentity.Controllers.DeviceController.Callback (StsServerIdentity), returned result Microsoft.AspNetCore.Mvc.ViewResult in 34.8218ms.
2019-02-19 11:50:40.132 +01:00 [INF] Executing ViewResult, running view Success.
2019-02-19 11:50:40.146 +01:00 [INF] Executed ViewResult - view Success executed in 24.834400000000002ms.
2019-02-19 11:50:40.146 +01:00 [INF] Executed action StsServerIdentity.Controllers.DeviceController.Callback (StsServerIdentity) in 187.62800000000001ms
2019-02-19 11:50:40.147 +01:00 [INF] Executed endpoint 'StsServerIdentity.Controllers.DeviceController.Callback (StsServerIdentity)'
2019-02-19 11:50:40.148 +01:00 [INF] Request finished in 225.4326ms 200 text/html; charset=utf-8
2019-02-19 11:50:43.179 +01:00 [INF] Request starting HTTP/1.1 GET http://localhost:44352/.well-known/openid-configuration  
2019-02-19 11:50:43.179 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-02-19 11:50:43.180 +01:00 [INF] Request finished in 1.2901ms 200 application/json; charset=UTF-8
2019-02-19 11:50:43.183 +01:00 [INF] Request starting HTTP/1.1 GET http://localhost:44352/.well-known/openid-configuration/jwks  
2019-02-19 11:50:43.183 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2019-02-19 11:50:43.184 +01:00 [INF] Request finished in 1.1612ms 200 application/jwk-set+json; charset=UTF-8
2019-02-19 11:50:43.207 +01:00 [INF] Request starting HTTP/1.1 POST http://localhost:44352/connect/token application/x-www-form-urlencoded 172
2019-02-19 11:50:43.212 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.TokenEndpoint for /connect/token
2019-02-19 11:50:43.245 +01:00 [INF] Entity Framework Core 2.2.2-servicing-10034 initialized 'ApplicationDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer' with options: None
2019-02-19 11:50:43.348 +01:00 [INF] Executed DbCommand (82ms) [Parameters=[@__get_Item_0='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [e].[Id], [e].[AccessFailedCount], [e].[ConcurrencyStamp], [e].[DataEventRecordsRole], [e].[Email], [e].[EmailConfirmed], [e].[IsAdmin], [e].[LockoutEnabled], [e].[LockoutEnd], [e].[NormalizedEmail], [e].[NormalizedUserName], [e].[PasswordHash], [e].[PhoneNumber], [e].[PhoneNumberConfirmed], [e].[SecuredFilesRole], [e].[SecurityStamp], [e].[TwoFactorEnabled], [e].[UserName]
FROM [AspNetUsers] AS [e]
WHERE [e].[Id] = @__get_Item_0
2019-02-19 11:50:43.368 +01:00 [INF] Token request validation success
{"ClientId":"deviceFlowWebClient","ClientName":"Device Flow Client","GrantType":"urn:ietf:params:oauth:grant-type:device_code","Scopes":null,"AuthorizationCode":null,"RefreshToken":null,"UserName":null,"AuthenticationContextReferenceClasses":null,"Tenant":null,"IdP":null,"Raw":{"device_code":"***REDACTED***","grant_type":"urn:ietf:params:oauth:grant-type:device_code","client_id":"deviceFlowWebClient"},"$type":"TokenRequestValidationLog"}
2019-02-19 11:50:43.450 +01:00 [INF] Executed DbCommand (49ms) [Parameters=[@__user_Id_0='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT [uc].[Id], [uc].[ClaimType], [uc].[ClaimValue], [uc].[UserId]
FROM [AspNetUserClaims] AS [uc]
WHERE [uc].[UserId] = @__user_Id_0
2019-02-19 11:50:43.479 +01:00 [INF] Executed DbCommand (27ms) [Parameters=[@__userId_0='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT [role].[Name]
FROM [AspNetUserRoles] AS [userRole]
INNER JOIN [AspNetRoles] AS [role] ON [userRole].[RoleId] = [role].[Id]
WHERE [userRole].[UserId] = @__userId_0
2019-02-19 11:50:43.591 +01:00 [INF] Executed DbCommand (40ms) [Parameters=[@__user_Id_0='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT [uc].[Id], [uc].[ClaimType], [uc].[ClaimValue], [uc].[UserId]
FROM [AspNetUserClaims] AS [uc]
WHERE [uc].[UserId] = @__user_Id_0
2019-02-19 11:50:43.617 +01:00 [INF] Executed DbCommand (25ms) [Parameters=[@__userId_0='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT [role].[Name]
FROM [AspNetUserRoles] AS [userRole]
INNER JOIN [AspNetRoles] AS [role] ON [userRole].[RoleId] = [role].[Id]
WHERE [userRole].[UserId] = @__userId_0
2019-02-19 11:50:43.634 +01:00 [INF] Request finished in 426.3028ms 200 application/json; charset=UTF-8
2019-02-19 11:56:47.620 +01:00 [INF] User profile is available. Using 'C:\Users\stduser\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2019-02-19 11:56:47.981 +01:00 [INF] Starting IdentityServer4 version 2.3.2.0
2019-02-19 11:56:48.003 +01:00 [INF] You are using the in-memory version of the persisted grant store. This will store consent decisions, authorization codes, refresh and reference tokens in memory only. If you are using any of those features in production, you want to switch to a different store implementation.
2019-02-19 11:56:48.028 +01:00 [INF] Using the default authentication scheme Identity.Application for IdentityServer
2019-02-19 11:56:50.148 +01:00 [INF] Request starting HTTP/1.1 GET http://localhost:44352/  
2019-02-19 11:56:50.148 +01:00 [INF] Request starting HTTP/1.1 DEBUG http://localhost:44352/  0
2019-02-19 11:56:50.195 +01:00 [INF] Request finished in 47.308ms 200 
2019-02-19 11:56:50.837 +01:00 [INF] Request starting HTTP/1.1 GET http://localhost:44352/.well-known/openid-configuration  
2019-02-19 11:56:50.905 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-02-19 11:56:50.948 +01:00 [INF] Executing endpoint 'StsServerIdentity.Controllers.HomeController.Index (StsServerIdentity)'
2019-02-19 11:56:50.982 +01:00 [INF] Route matched with {action = "Index", controller = "Home"}. Executing action StsServerIdentity.Controllers.HomeController.Index (StsServerIdentity)
2019-02-19 11:56:51.120 +01:00 [INF] Executing action method StsServerIdentity.Controllers.HomeController.Index (StsServerIdentity) - Validation state: "Valid"
2019-02-19 11:56:51.132 +01:00 [INF] Executed action method StsServerIdentity.Controllers.HomeController.Index (StsServerIdentity), returned result Microsoft.AspNetCore.Mvc.ViewResult in 0.7975ms.
2019-02-19 11:56:51.177 +01:00 [INF] Request finished in 338.745ms 200 application/json; charset=UTF-8
2019-02-19 11:56:51.182 +01:00 [INF] Executing ViewResult, running view Index.
2019-02-19 11:56:51.358 +01:00 [INF] Request starting HTTP/1.1 GET http://localhost:44352/.well-known/openid-configuration/jwks  
2019-02-19 11:56:51.366 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2019-02-19 11:56:51.705 +01:00 [INF] Request finished in 347.0335ms 200 application/jwk-set+json; charset=UTF-8
2019-02-19 11:56:51.819 +01:00 [INF] Request starting HTTP/1.1 GET http://localhost:44352/connect/authorize?client_id=hybridclient&redirect_uri=https%3A%2F%2Flocalhost%3A44329%2Fsignin-oidc&response_type=code%20id_token&scope=openid%20profile%20scope_used_for_hybrid_flow%20offline_access&response_mode=form_post&nonce=636861706117602330.OTQzNDVlNWQtYTFiMi00MGY5LThlMDItMTM3MjdjOTNlNTA2ODczOTNlOTQtMjAxNS00MTE2LWE2YmUtODljOGQ5YTczNjA0&state=CfDJ8CGpEylrt0pIt6txpyTWMbSKGaYvFbfNzC58W52u7PGiMiR9FVoxnnc4__U0J8T5LtrNZG8ueCvFYX7sONnijJrrvp3PD4SCdZX6667DdNSP-Ng_HQxqFsyEFPJqFPA_N6aCRzJktUk42WdVws-fw7BtplE3zj72_5VeA2xl2NYVX3NPcms-krNJLDCmGNB7ZNqzWoesaLYjERjElGCJjzKeGLj7vOF7T7HESVwPFwGlrunb2LvQqBE9EFpip3YjW4RSDsKutVEuyYHox_HiBBPpphAL1aXTBW55K0eLNOyFi_IWczUEtTPwDRRcBmiEpnmmAapjpMOu9erUytFx50E&x-client-SKU=ID_NETSTANDARD2_0&x-client-ver=5.3.0.0  
2019-02-19 11:56:51.893 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2019-02-19 11:56:51.936 +01:00 [INF] Executed ViewResult - view Index executed in 792.44900000000007ms.
2019-02-19 11:56:51.937 +01:00 [INF] Executed action StsServerIdentity.Controllers.HomeController.Index (StsServerIdentity) in 954.10620000000006ms
2019-02-19 11:56:51.937 +01:00 [INF] Executed endpoint 'StsServerIdentity.Controllers.HomeController.Index (StsServerIdentity)'
2019-02-19 11:56:51.940 +01:00 [INF] Request finished in 1799.2262ms 200 text/html; charset=utf-8
2019-02-19 11:56:51.953 +01:00 [INF] Request starting HTTP/1.1 GET http://localhost:44352/css/vendor.min.css?v=RtIwopEx0osLqdXB1F1QPDFWzutpmmdukcoICaRWUFI  
2019-02-19 11:56:51.964 +01:00 [INF] Request starting HTTP/1.1 GET http://localhost:44352/js/vendor.min.js?v=yg3700ylkpEbw8o9sR1SsYLHNI0v7pw6lI42YH1q40o  
2019-02-19 11:56:51.965 +01:00 [INF] Request starting HTTP/1.1 GET http://localhost:44352/js/site.min.js?v=47DEQpj8HBSa-_TImW-5JCeuQeRkm5NMpJWZG3hSuFU  
2019-02-19 11:56:51.966 +01:00 [INF] Request starting HTTP/1.1 GET http://localhost:44352/css/site.min.css?v=9n42HB2zuqXKDsr8sMaXB5eFvO87SuAf1CjiV4cv1Fg  
2019-02-19 11:56:51.977 +01:00 [INF] Sending file. Request path: '/js/site.min.js'. Physical path: 'C:\git\damienbod\AspNetCoreHybridFlowWithApi\StsServer\wwwroot\js\site.min.js'
2019-02-19 11:56:51.978 +01:00 [INF] Request finished in 13.1165ms 200 application/javascript
2019-02-19 11:56:52.003 +01:00 [INF] Sending file. Request path: '/css/site.min.css'. Physical path: 'C:\git\damienbod\AspNetCoreHybridFlowWithApi\StsServer\wwwroot\css\site.min.css'
2019-02-19 11:56:52.010 +01:00 [INF] Sending file. Request path: '/js/vendor.min.js'. Physical path: 'C:\git\damienbod\AspNetCoreHybridFlowWithApi\StsServer\wwwroot\js\vendor.min.js'
2019-02-19 11:56:52.010 +01:00 [INF] Sending file. Request path: '/css/vendor.min.css'. Physical path: 'C:\git\damienbod\AspNetCoreHybridFlowWithApi\StsServer\wwwroot\css\vendor.min.css'
2019-02-19 11:56:52.026 +01:00 [INF] Request finished in 60.076ms 200 text/css
2019-02-19 11:56:52.026 +01:00 [INF] Request finished in 61.9931ms 200 application/javascript
2019-02-19 11:56:52.027 +01:00 [INF] Request finished in 73.6363ms 200 text/css
2019-02-19 11:56:52.092 +01:00 [INF] ValidatedAuthorizeRequest
{"ClientId":"hybridclient","ClientName":"hybridclient","RedirectUri":"https://localhost:44329/signin-oidc","AllowedRedirectUris":["https://localhost:44329/signin-oidc"],"SubjectId":"06283e9f-fb29-4334-9bab-ad5409e1eb30","ResponseType":"code id_token","ResponseMode":"form_post","GrantType":"hybrid","RequestedScopes":"openid profile scope_used_for_hybrid_flow offline_access","State":"CfDJ8CGpEylrt0pIt6txpyTWMbSKGaYvFbfNzC58W52u7PGiMiR9FVoxnnc4__U0J8T5LtrNZG8ueCvFYX7sONnijJrrvp3PD4SCdZX6667DdNSP-Ng_HQxqFsyEFPJqFPA_N6aCRzJktUk42WdVws-fw7BtplE3zj72_5VeA2xl2NYVX3NPcms-krNJLDCmGNB7ZNqzWoesaLYjERjElGCJjzKeGLj7vOF7T7HESVwPFwGlrunb2LvQqBE9EFpip3YjW4RSDsKutVEuyYHox_HiBBPpphAL1aXTBW55K0eLNOyFi_IWczUEtTPwDRRcBmiEpnmmAapjpMOu9erUytFx50E","UiLocales":null,"Nonce":"636861706117602330.OTQzNDVlNWQtYTFiMi00MGY5LThlMDItMTM3MjdjOTNlNTA2ODczOTNlOTQtMjAxNS00MTE2LWE2YmUtODljOGQ5YTczNjA0","AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":"5e3446ef958a5877266c3cef6f3fed8c","Raw":{"client_id":"hybridclient","redirect_uri":"https://localhost:44329/signin-oidc","response_type":"code id_token","scope":"openid profile scope_used_for_hybrid_flow offline_access","response_mode":"form_post","nonce":"636861706117602330.OTQzNDVlNWQtYTFiMi00MGY5LThlMDItMTM3MjdjOTNlNTA2ODczOTNlOTQtMjAxNS00MTE2LWE2YmUtODljOGQ5YTczNjA0","state":"CfDJ8CGpEylrt0pIt6txpyTWMbSKGaYvFbfNzC58W52u7PGiMiR9FVoxnnc4__U0J8T5LtrNZG8ueCvFYX7sONnijJrrvp3PD4SCdZX6667DdNSP-Ng_HQxqFsyEFPJqFPA_N6aCRzJktUk42WdVws-fw7BtplE3zj72_5VeA2xl2NYVX3NPcms-krNJLDCmGNB7ZNqzWoesaLYjERjElGCJjzKeGLj7vOF7T7HESVwPFwGlrunb2LvQqBE9EFpip3YjW4RSDsKutVEuyYHox_HiBBPpphAL1aXTBW55K0eLNOyFi_IWczUEtTPwDRRcBmiEpnmmAapjpMOu9erUytFx50E","x-client-SKU":"ID_NETSTANDARD2_0","x-client-ver":"5.3.0.0"},"$type":"AuthorizeRequestValidationLog"}
2019-02-19 11:56:52.761 +01:00 [INF] Entity Framework Core 2.2.2-servicing-10034 initialized 'ApplicationDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer' with options: None
2019-02-19 11:56:53.433 +01:00 [INF] Executed DbCommand (76ms) [Parameters=[@__get_Item_0='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [e].[Id], [e].[AccessFailedCount], [e].[ConcurrencyStamp], [e].[DataEventRecordsRole], [e].[Email], [e].[EmailConfirmed], [e].[IsAdmin], [e].[LockoutEnabled], [e].[LockoutEnd], [e].[NormalizedEmail], [e].[NormalizedUserName], [e].[PasswordHash], [e].[PhoneNumber], [e].[PhoneNumberConfirmed], [e].[SecuredFilesRole], [e].[SecurityStamp], [e].[TwoFactorEnabled], [e].[UserName]
FROM [AspNetUsers] AS [e]
WHERE [e].[Id] = @__get_Item_0
2019-02-19 11:56:53.472 +01:00 [INF] Request starting HTTP/1.1 GET http://localhost:44352/.well-known/openid-configuration  
2019-02-19 11:56:53.473 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-02-19 11:56:53.474 +01:00 [INF] Request finished in 1.3076ms 200 application/json; charset=UTF-8
2019-02-19 11:56:53.515 +01:00 [INF] Request starting HTTP/1.1 GET http://localhost:44352/.well-known/openid-configuration/jwks  
2019-02-19 11:56:53.515 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2019-02-19 11:56:53.516 +01:00 [INF] Request finished in 1.1326ms 200 application/jwk-set+json; charset=UTF-8
2019-02-19 11:56:53.598 +01:00 [INF] Showing consent: User has not yet consented
2019-02-19 11:56:53.609 +01:00 [INF] Request finished in 1790.2706ms 302 
2019-02-19 11:56:53.612 +01:00 [INF] Request starting HTTP/1.1 GET http://localhost:44352/consent?returnUrl=%2Fconnect%2Fauthorize%2Fcallback%3Fclient_id%3Dhybridclient%26redirect_uri%3Dhttps%253A%252F%252Flocalhost%253A44329%252Fsignin-oidc%26response_type%3Dcode%2520id_token%26scope%3Dopenid%2520profile%2520scope_used_for_hybrid_flow%2520offline_access%26response_mode%3Dform_post%26nonce%3D636861706117602330.OTQzNDVlNWQtYTFiMi00MGY5LThlMDItMTM3MjdjOTNlNTA2ODczOTNlOTQtMjAxNS00MTE2LWE2YmUtODljOGQ5YTczNjA0%26state%3DCfDJ8CGpEylrt0pIt6txpyTWMbSKGaYvFbfNzC58W52u7PGiMiR9FVoxnnc4__U0J8T5LtrNZG8ueCvFYX7sONnijJrrvp3PD4SCdZX6667DdNSP-Ng_HQxqFsyEFPJqFPA_N6aCRzJktUk42WdVws-fw7BtplE3zj72_5VeA2xl2NYVX3NPcms-krNJLDCmGNB7ZNqzWoesaLYjERjElGCJjzKeGLj7vOF7T7HESVwPFwGlrunb2LvQqBE9EFpip3YjW4RSDsKutVEuyYHox_HiBBPpphAL1aXTBW55K0eLNOyFi_IWczUEtTPwDRRcBmiEpnmmAapjpMOu9erUytFx50E%26x-client-SKU%3DID_NETSTANDARD2_0%26x-client-ver%3D5.3.0.0  
2019-02-19 11:56:53.619 +01:00 [INF] Executing endpoint 'StsServerIdentity.Controllers.ConsentController.Index (StsServerIdentity)'
2019-02-19 11:56:53.638 +01:00 [INF] Route matched with {action = "Index", controller = "Consent"}. Executing action StsServerIdentity.Controllers.ConsentController.Index (StsServerIdentity)
2019-02-19 11:56:53.649 +01:00 [INF] Request starting HTTP/1.1 POST http://localhost:44352/connect/deviceauthorization application/x-www-form-urlencoded 56
2019-02-19 11:56:53.652 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DeviceAuthorizationEndpoint for /connect/deviceauthorization
2019-02-19 11:56:53.678 +01:00 [INF] Executing action method StsServerIdentity.Controllers.ConsentController.Index (StsServerIdentity) with arguments (["/connect/authorize/callback?client_id=hybridclient&redirect_uri=https%3A%2F%2Flocalhost%3A44329%2Fsignin-oidc&response_type=code%20id_token&scope=openid%20profile%20scope_used_for_hybrid_flow%20offline_access&response_mode=form_post&nonce=636861706117602330.OTQzNDVlNWQtYTFiMi00MGY5LThlMDItMTM3MjdjOTNlNTA2ODczOTNlOTQtMjAxNS00MTE2LWE2YmUtODljOGQ5YTczNjA0&state=CfDJ8CGpEylrt0pIt6txpyTWMbSKGaYvFbfNzC58W52u7PGiMiR9FVoxnnc4__U0J8T5LtrNZG8ueCvFYX7sONnijJrrvp3PD4SCdZX6667DdNSP-Ng_HQxqFsyEFPJqFPA_N6aCRzJktUk42WdVws-fw7BtplE3zj72_5VeA2xl2NYVX3NPcms-krNJLDCmGNB7ZNqzWoesaLYjERjElGCJjzKeGLj7vOF7T7HESVwPFwGlrunb2LvQqBE9EFpip3YjW4RSDsKutVEuyYHox_HiBBPpphAL1aXTBW55K0eLNOyFi_IWczUEtTPwDRRcBmiEpnmmAapjpMOu9erUytFx50E&x-client-SKU=ID_NETSTANDARD2_0&x-client-ver=5.3.0.0"]) - Validation state: "Valid"
2019-02-19 11:56:53.699 +01:00 [INF] Executed action method StsServerIdentity.Controllers.ConsentController.Index (StsServerIdentity), returned result Microsoft.AspNetCore.Mvc.ViewResult in 20.2588ms.
2019-02-19 11:56:53.701 +01:00 [INF] Executing ViewResult, running view Index.
2019-02-19 11:56:53.750 +01:00 [INF] Request finished in 101.2144ms 200 application/json; charset=UTF-8
2019-02-19 11:56:53.752 +01:00 [INF] Executed ViewResult - view Index executed in 53.0899ms.
2019-02-19 11:56:53.752 +01:00 [INF] Executed action StsServerIdentity.Controllers.ConsentController.Index (StsServerIdentity) in 114.2976ms
2019-02-19 11:56:53.752 +01:00 [INF] Executed endpoint 'StsServerIdentity.Controllers.ConsentController.Index (StsServerIdentity)'
2019-02-19 11:56:53.752 +01:00 [INF] Request finished in 140.3383ms 200 text/html; charset=utf-8
2019-02-19 11:56:59.920 +01:00 [INF] Request starting HTTP/1.1 GET http://localhost:44352/device  
2019-02-19 11:56:59.934 +01:00 [INF] Executing endpoint 'StsServerIdentity.Controllers.DeviceController.Index (StsServerIdentity)'
2019-02-19 11:56:59.955 +01:00 [INF] Route matched with {action = "Index", controller = "Device"}. Executing action StsServerIdentity.Controllers.DeviceController.Index (StsServerIdentity)
2019-02-19 11:56:59.983 +01:00 [INF] Authorization was successful.
2019-02-19 11:57:00.021 +01:00 [INF] Executing action method StsServerIdentity.Controllers.DeviceController.Index (StsServerIdentity) with arguments ([""]) - Validation state: "Valid"
2019-02-19 11:57:00.023 +01:00 [INF] Executed action method StsServerIdentity.Controllers.DeviceController.Index (StsServerIdentity), returned result Microsoft.AspNetCore.Mvc.ViewResult in 1.5476ms.
2019-02-19 11:57:00.028 +01:00 [INF] Executing ViewResult, running view UserCodeCapture.
2019-02-19 11:57:00.043 +01:00 [INF] Executed ViewResult - view UserCodeCapture executed in 19.9447ms.
2019-02-19 11:57:00.043 +01:00 [INF] Executed action StsServerIdentity.Controllers.DeviceController.Index (StsServerIdentity) in 87.772ms
2019-02-19 11:57:00.043 +01:00 [INF] Executed endpoint 'StsServerIdentity.Controllers.DeviceController.Index (StsServerIdentity)'
2019-02-19 11:57:00.043 +01:00 [INF] Request finished in 123.5393ms 200 text/html; charset=utf-8
2019-02-19 11:57:00.205 +01:00 [INF] Request starting HTTP/1.1 GET http://localhost:44352/device  
2019-02-19 11:57:00.206 +01:00 [INF] Executing endpoint 'StsServerIdentity.Controllers.DeviceController.Index (StsServerIdentity)'
2019-02-19 11:57:00.207 +01:00 [INF] Route matched with {action = "Index", controller = "Device"}. Executing action StsServerIdentity.Controllers.DeviceController.Index (StsServerIdentity)
2019-02-19 11:57:00.208 +01:00 [INF] Authorization was successful.
2019-02-19 11:57:00.262 +01:00 [INF] Executing action method StsServerIdentity.Controllers.DeviceController.Index (StsServerIdentity) with arguments ([""]) - Validation state: "Valid"
2019-02-19 11:57:00.262 +01:00 [INF] Executed action method StsServerIdentity.Controllers.DeviceController.Index (StsServerIdentity), returned result Microsoft.AspNetCore.Mvc.ViewResult in 0.0538ms.
2019-02-19 11:57:00.262 +01:00 [INF] Executing ViewResult, running view UserCodeCapture.
2019-02-19 11:57:00.264 +01:00 [INF] Executed ViewResult - view UserCodeCapture executed in 2.3335ms.
2019-02-19 11:57:00.265 +01:00 [INF] Executed action StsServerIdentity.Controllers.DeviceController.Index (StsServerIdentity) in 57.549ms
2019-02-19 11:57:00.265 +01:00 [INF] Executed endpoint 'StsServerIdentity.Controllers.DeviceController.Index (StsServerIdentity)'
2019-02-19 11:57:00.265 +01:00 [INF] Request finished in 59.9621ms 200 text/html; charset=utf-8
2019-02-19 11:57:07.236 +01:00 [INF] Request starting HTTP/1.1 POST http://localhost:44352/Device/UserCodeCapture application/x-www-form-urlencoded 244
2019-02-19 11:57:07.264 +01:00 [INF] Executing endpoint 'StsServerIdentity.Controllers.DeviceController.UserCodeCapture (StsServerIdentity)'
2019-02-19 11:57:07.270 +01:00 [INF] Route matched with {action = "UserCodeCapture", controller = "Device"}. Executing action StsServerIdentity.Controllers.DeviceController.UserCodeCapture (StsServerIdentity)
2019-02-19 11:57:07.270 +01:00 [INF] Authorization was successful.
2019-02-19 11:57:07.315 +01:00 [INF] Executing action method StsServerIdentity.Controllers.DeviceController.UserCodeCapture (StsServerIdentity) with arguments (["884080781"]) - Validation state: "Valid"
2019-02-19 11:57:07.324 +01:00 [INF] Executed action method StsServerIdentity.Controllers.DeviceController.UserCodeCapture (StsServerIdentity), returned result Microsoft.AspNetCore.Mvc.ViewResult in 9.4317000000000011ms.
2019-02-19 11:57:07.330 +01:00 [INF] Executing ViewResult, running view UserCodeConfirmation.
2019-02-19 11:57:07.355 +01:00 [INF] Executed ViewResult - view UserCodeConfirmation executed in 30.8441ms.
2019-02-19 11:57:07.355 +01:00 [INF] Executed action StsServerIdentity.Controllers.DeviceController.UserCodeCapture (StsServerIdentity) in 85.1747ms
2019-02-19 11:57:07.355 +01:00 [INF] Executed endpoint 'StsServerIdentity.Controllers.DeviceController.UserCodeCapture (StsServerIdentity)'
2019-02-19 11:57:07.356 +01:00 [INF] Request finished in 119.8045ms 200 text/html; charset=utf-8
2019-02-19 11:57:08.665 +01:00 [INF] Request starting HTTP/1.1 POST http://localhost:44352/Device/Callback application/x-www-form-urlencoded 367
2019-02-19 11:57:08.669 +01:00 [INF] Executing endpoint 'StsServerIdentity.Controllers.DeviceController.Callback (StsServerIdentity)'
2019-02-19 11:57:08.683 +01:00 [INF] Route matched with {action = "Callback", controller = "Device"}. Executing action StsServerIdentity.Controllers.DeviceController.Callback (StsServerIdentity)
2019-02-19 11:57:08.684 +01:00 [INF] Authorization was successful.
2019-02-19 11:57:08.756 +01:00 [INF] Executing action method StsServerIdentity.Controllers.DeviceController.Callback (StsServerIdentity) with arguments (["StsServerIdentity.Models.DeviceAuthorizationInputModel"]) - Validation state: "Valid"
2019-02-19 11:57:08.770 +01:00 [INF] Executed action method StsServerIdentity.Controllers.DeviceController.Callback (StsServerIdentity), returned result Microsoft.AspNetCore.Mvc.ViewResult in 13.839ms.
2019-02-19 11:57:08.773 +01:00 [INF] Executing ViewResult, running view Success.
2019-02-19 11:57:08.781 +01:00 [INF] Executed ViewResult - view Success executed in 10.6506ms.
2019-02-19 11:57:08.781 +01:00 [INF] Executed action StsServerIdentity.Controllers.DeviceController.Callback (StsServerIdentity) in 97.5117ms
2019-02-19 11:57:08.781 +01:00 [INF] Executed endpoint 'StsServerIdentity.Controllers.DeviceController.Callback (StsServerIdentity)'
2019-02-19 11:57:08.781 +01:00 [INF] Request finished in 116.6389ms 200 text/html; charset=utf-8
2019-02-19 11:57:11.343 +01:00 [INF] Request starting HTTP/1.1 GET http://localhost:44352/.well-known/openid-configuration  
2019-02-19 11:57:11.345 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-02-19 11:57:11.346 +01:00 [INF] Request finished in 3.3541ms 200 application/json; charset=UTF-8
2019-02-19 11:57:11.375 +01:00 [INF] Request starting HTTP/1.1 GET http://localhost:44352/.well-known/openid-configuration/jwks  
2019-02-19 11:57:11.376 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2019-02-19 11:57:11.377 +01:00 [INF] Request finished in 2.5507ms 200 application/jwk-set+json; charset=UTF-8
2019-02-19 11:57:11.399 +01:00 [INF] Request starting HTTP/1.1 POST http://localhost:44352/connect/token application/x-www-form-urlencoded 172
2019-02-19 11:57:11.403 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.TokenEndpoint for /connect/token
2019-02-19 11:57:11.444 +01:00 [INF] Entity Framework Core 2.2.2-servicing-10034 initialized 'ApplicationDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer' with options: None
2019-02-19 11:57:11.503 +01:00 [INF] Executed DbCommand (49ms) [Parameters=[@__get_Item_0='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [e].[Id], [e].[AccessFailedCount], [e].[ConcurrencyStamp], [e].[DataEventRecordsRole], [e].[Email], [e].[EmailConfirmed], [e].[IsAdmin], [e].[LockoutEnabled], [e].[LockoutEnd], [e].[NormalizedEmail], [e].[NormalizedUserName], [e].[PasswordHash], [e].[PhoneNumber], [e].[PhoneNumberConfirmed], [e].[SecuredFilesRole], [e].[SecurityStamp], [e].[TwoFactorEnabled], [e].[UserName]
FROM [AspNetUsers] AS [e]
WHERE [e].[Id] = @__get_Item_0
2019-02-19 11:57:11.512 +01:00 [INF] Token request validation success
{"ClientId":"deviceFlowWebClient","ClientName":"Device Flow Client","GrantType":"urn:ietf:params:oauth:grant-type:device_code","Scopes":null,"AuthorizationCode":null,"RefreshToken":null,"UserName":null,"AuthenticationContextReferenceClasses":null,"Tenant":null,"IdP":null,"Raw":{"device_code":"***REDACTED***","grant_type":"urn:ietf:params:oauth:grant-type:device_code","client_id":"deviceFlowWebClient"},"$type":"TokenRequestValidationLog"}
2019-02-19 11:57:11.692 +01:00 [INF] Executed DbCommand (60ms) [Parameters=[@__user_Id_0='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT [uc].[Id], [uc].[ClaimType], [uc].[ClaimValue], [uc].[UserId]
FROM [AspNetUserClaims] AS [uc]
WHERE [uc].[UserId] = @__user_Id_0
2019-02-19 11:57:11.763 +01:00 [INF] Executed DbCommand (18ms) [Parameters=[@__userId_0='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT [role].[Name]
FROM [AspNetUserRoles] AS [userRole]
INNER JOIN [AspNetRoles] AS [role] ON [userRole].[RoleId] = [role].[Id]
WHERE [userRole].[UserId] = @__userId_0
2019-02-19 11:57:11.873 +01:00 [INF] Executed DbCommand (29ms) [Parameters=[@__user_Id_0='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT [uc].[Id], [uc].[ClaimType], [uc].[ClaimValue], [uc].[UserId]
FROM [AspNetUserClaims] AS [uc]
WHERE [uc].[UserId] = @__user_Id_0
2019-02-19 11:57:11.901 +01:00 [INF] Executed DbCommand (26ms) [Parameters=[@__userId_0='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT [role].[Name]
FROM [AspNetUserRoles] AS [userRole]
INNER JOIN [AspNetRoles] AS [role] ON [userRole].[RoleId] = [role].[Id]
WHERE [userRole].[UserId] = @__userId_0
2019-02-19 11:57:11.918 +01:00 [INF] Request finished in 519.478ms 200 application/json; charset=UTF-8
2019-02-19 11:57:22.619 +01:00 [INF] Request starting HTTP/1.1 GET http://localhost:44352/.well-known/openid-configuration  
2019-02-19 11:57:22.620 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-02-19 11:57:22.621 +01:00 [INF] Request finished in 1.071ms 200 application/json; charset=UTF-8
2019-02-19 11:57:22.623 +01:00 [INF] Request starting HTTP/1.1 GET http://localhost:44352/.well-known/openid-configuration/jwks  
2019-02-19 11:57:22.623 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2019-02-19 11:57:22.624 +01:00 [INF] Request finished in 0.9357ms 200 application/jwk-set+json; charset=UTF-8
2019-02-19 11:57:22.642 +01:00 [INF] Request starting HTTP/1.1 POST http://localhost:44352/connect/deviceauthorization application/x-www-form-urlencoded 56
2019-02-19 11:57:22.643 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DeviceAuthorizationEndpoint for /connect/deviceauthorization
2019-02-19 11:57:22.646 +01:00 [INF] Request finished in 3.3289ms 200 application/json; charset=UTF-8
2019-02-19 11:57:25.358 +01:00 [INF] Request starting HTTP/1.1 GET http://localhost:44352/.well-known/openid-configuration  
2019-02-19 11:57:25.358 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-02-19 11:57:25.359 +01:00 [INF] Request finished in 1.0012ms 200 application/json; charset=UTF-8
2019-02-19 11:57:25.365 +01:00 [INF] Request starting HTTP/1.1 GET http://localhost:44352/.well-known/openid-configuration/jwks  
2019-02-19 11:57:25.367 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2019-02-19 11:57:25.368 +01:00 [INF] Request finished in 3.6072ms 200 application/jwk-set+json; charset=UTF-8
2019-02-19 11:57:25.378 +01:00 [INF] Request starting HTTP/1.1 POST http://localhost:44352/connect/token application/x-www-form-urlencoded 172
2019-02-19 11:57:25.380 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.TokenEndpoint for /connect/token
2019-02-19 11:57:25.383 +01:00 [ERR] Invalid device code
2019-02-19 11:57:25.390 +01:00 [INF] Request finished in 12.286ms 400 application/json; charset=UTF-8
2019-02-19 12:28:33.014 +01:00 [INF] User profile is available. Using 'C:\Users\stduser\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2019-02-19 12:28:33.454 +01:00 [INF] Starting IdentityServer4 version 2.3.2.0
2019-02-19 12:28:33.481 +01:00 [INF] You are using the in-memory version of the persisted grant store. This will store consent decisions, authorization codes, refresh and reference tokens in memory only. If you are using any of those features in production, you want to switch to a different store implementation.
2019-02-19 12:28:33.510 +01:00 [INF] Using the default authentication scheme Identity.Application for IdentityServer
2019-02-19 12:28:35.859 +01:00 [INF] Request starting HTTP/1.1 DEBUG http://localhost:44352/  0
2019-02-19 12:28:35.859 +01:00 [INF] Request starting HTTP/1.1 GET http://localhost:44352/  
2019-02-19 12:28:35.911 +01:00 [INF] Request finished in 51.9083ms 200 
2019-02-19 12:28:37.096 +01:00 [INF] Request starting HTTP/1.1 GET http://localhost:44352/.well-known/openid-configuration  
2019-02-19 12:28:37.178 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-02-19 12:28:37.363 +01:00 [INF] Request finished in 267.8519ms 200 application/json; charset=UTF-8
2019-02-19 12:28:37.499 +01:00 [INF] Request starting HTTP/1.1 GET http://localhost:44352/.well-known/openid-configuration/jwks  
2019-02-19 12:28:37.500 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2019-02-19 12:28:37.556 +01:00 [INF] Request finished in 57.0501ms 200 application/jwk-set+json; charset=UTF-8
2019-02-19 12:28:37.624 +01:00 [INF] Request starting HTTP/1.1 GET http://localhost:44352/connect/authorize?client_id=hybridclient&redirect_uri=https%3A%2F%2Flocalhost%3A44329%2Fsignin-oidc&response_type=code%20id_token&scope=openid%20profile%20scope_used_for_hybrid_flow%20offline_access&response_mode=form_post&nonce=636861725175898743.MzY4NTk2YzQtNjA5Yy00YjQ1LTk5ZWEtN2Y0ZGEwODE5NTc0N2IzNjBmYzUtNmZkMi00OGEzLWJkNTEtNGMwZDI0MmUxODgz&state=CfDJ8CGpEylrt0pIt6txpyTWMbRWgv-c0Tzm-r1_wF11jqDzecyS1pscDzuprVBaSr5Du2f1V5i8LGaVakhwVbO0FHDeDOeNJdIU7fPHDWi89pPCF-SW4JxlObfsyNpuePKtMktU2a34Z9C0BDklPICkZfSrNatQfif3P3XiIE1CrhR7J7TeXZIM4qd2JSeR7_1eh2xZsOhXne4o7KJcyMxUPqd_wY0c2sLMJ_b-ZkR9pFXB2PubE3d6n3OEdP4jNBOOHir6dETqzq21pdcUtDfZYopPu7Kmx2KsiQWMPeNMSGGaBfKMQqU3OohMUIR07sZ4yAmxLcIU0Dl6RqhwpLFuS_s&x-client-SKU=ID_NETSTANDARD2_0&x-client-ver=5.3.0.0  
2019-02-19 12:28:37.693 +01:00 [INF] Entity Framework Core 2.2.2-servicing-10034 initialized 'ApplicationDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer' with options: None
2019-02-19 12:28:37.693 +01:00 [INF] Entity Framework Core 2.2.2-servicing-10034 initialized 'ApplicationDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer' with options: None
2019-02-19 12:28:38.295 +01:00 [INF] Executed DbCommand (54ms) [Parameters=[@__get_Item_0='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [e].[Id], [e].[AccessFailedCount], [e].[ConcurrencyStamp], [e].[DataEventRecordsRole], [e].[Email], [e].[EmailConfirmed], [e].[IsAdmin], [e].[LockoutEnabled], [e].[LockoutEnd], [e].[NormalizedEmail], [e].[NormalizedUserName], [e].[PasswordHash], [e].[PhoneNumber], [e].[PhoneNumberConfirmed], [e].[SecuredFilesRole], [e].[SecurityStamp], [e].[TwoFactorEnabled], [e].[UserName]
FROM [AspNetUsers] AS [e]
WHERE [e].[Id] = @__get_Item_0
2019-02-19 12:28:38.295 +01:00 [INF] Executed DbCommand (54ms) [Parameters=[@__get_Item_0='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [e].[Id], [e].[AccessFailedCount], [e].[ConcurrencyStamp], [e].[DataEventRecordsRole], [e].[Email], [e].[EmailConfirmed], [e].[IsAdmin], [e].[LockoutEnabled], [e].[LockoutEnd], [e].[NormalizedEmail], [e].[NormalizedUserName], [e].[PasswordHash], [e].[PhoneNumber], [e].[PhoneNumberConfirmed], [e].[SecuredFilesRole], [e].[SecurityStamp], [e].[TwoFactorEnabled], [e].[UserName]
FROM [AspNetUsers] AS [e]
WHERE [e].[Id] = @__get_Item_0
2019-02-19 12:28:38.628 +01:00 [INF] Executed DbCommand (89ms) [Parameters=[@__user_Id_0='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT [uc].[Id], [uc].[ClaimType], [uc].[ClaimValue], [uc].[UserId]
FROM [AspNetUserClaims] AS [uc]
WHERE [uc].[UserId] = @__user_Id_0
2019-02-19 12:28:38.629 +01:00 [INF] Executed DbCommand (90ms) [Parameters=[@__user_Id_0='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT [uc].[Id], [uc].[ClaimType], [uc].[ClaimValue], [uc].[UserId]
FROM [AspNetUserClaims] AS [uc]
WHERE [uc].[UserId] = @__user_Id_0
2019-02-19 12:28:38.737 +01:00 [INF] Executed DbCommand (38ms) [Parameters=[@__userId_0='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT [role].[Name]
FROM [AspNetUserRoles] AS [userRole]
INNER JOIN [AspNetRoles] AS [role] ON [userRole].[RoleId] = [role].[Id]
WHERE [userRole].[UserId] = @__userId_0
2019-02-19 12:28:38.737 +01:00 [INF] Executed DbCommand (38ms) [Parameters=[@__userId_0='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT [role].[Name]
FROM [AspNetUserRoles] AS [userRole]
INNER JOIN [AspNetRoles] AS [role] ON [userRole].[RoleId] = [role].[Id]
WHERE [userRole].[UserId] = @__userId_0
2019-02-19 12:28:38.770 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2019-02-19 12:28:38.799 +01:00 [INF] Executing endpoint 'StsServerIdentity.Controllers.HomeController.Index (StsServerIdentity)'
2019-02-19 12:28:38.819 +01:00 [INF] Route matched with {action = "Index", controller = "Home"}. Executing action StsServerIdentity.Controllers.HomeController.Index (StsServerIdentity)
2019-02-19 12:28:38.907 +01:00 [INF] Executing action method StsServerIdentity.Controllers.HomeController.Index (StsServerIdentity) - Validation state: "Valid"
2019-02-19 12:28:38.911 +01:00 [INF] Executed action method StsServerIdentity.Controllers.HomeController.Index (StsServerIdentity), returned result Microsoft.AspNetCore.Mvc.ViewResult in 0.8484ms.
2019-02-19 12:28:38.950 +01:00 [INF] Executing ViewResult, running view Index.
2019-02-19 12:28:38.958 +01:00 [INF] ValidatedAuthorizeRequest
{"ClientId":"hybridclient","ClientName":"hybridclient","RedirectUri":"https://localhost:44329/signin-oidc","AllowedRedirectUris":["https://localhost:44329/signin-oidc"],"SubjectId":"06283e9f-fb29-4334-9bab-ad5409e1eb30","ResponseType":"code id_token","ResponseMode":"form_post","GrantType":"hybrid","RequestedScopes":"openid profile scope_used_for_hybrid_flow offline_access","State":"CfDJ8CGpEylrt0pIt6txpyTWMbRWgv-c0Tzm-r1_wF11jqDzecyS1pscDzuprVBaSr5Du2f1V5i8LGaVakhwVbO0FHDeDOeNJdIU7fPHDWi89pPCF-SW4JxlObfsyNpuePKtMktU2a34Z9C0BDklPICkZfSrNatQfif3P3XiIE1CrhR7J7TeXZIM4qd2JSeR7_1eh2xZsOhXne4o7KJcyMxUPqd_wY0c2sLMJ_b-ZkR9pFXB2PubE3d6n3OEdP4jNBOOHir6dETqzq21pdcUtDfZYopPu7Kmx2KsiQWMPeNMSGGaBfKMQqU3OohMUIR07sZ4yAmxLcIU0Dl6RqhwpLFuS_s","UiLocales":null,"Nonce":"636861725175898743.MzY4NTk2YzQtNjA5Yy00YjQ1LTk5ZWEtN2Y0ZGEwODE5NTc0N2IzNjBmYzUtNmZkMi00OGEzLWJkNTEtNGMwZDI0MmUxODgz","AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":"5e3446ef958a5877266c3cef6f3fed8c","Raw":{"client_id":"hybridclient","redirect_uri":"https://localhost:44329/signin-oidc","response_type":"code id_token","scope":"openid profile scope_used_for_hybrid_flow offline_access","response_mode":"form_post","nonce":"636861725175898743.MzY4NTk2YzQtNjA5Yy00YjQ1LTk5ZWEtN2Y0ZGEwODE5NTc0N2IzNjBmYzUtNmZkMi00OGEzLWJkNTEtNGMwZDI0MmUxODgz","state":"CfDJ8CGpEylrt0pIt6txpyTWMbRWgv-c0Tzm-r1_wF11jqDzecyS1pscDzuprVBaSr5Du2f1V5i8LGaVakhwVbO0FHDeDOeNJdIU7fPHDWi89pPCF-SW4JxlObfsyNpuePKtMktU2a34Z9C0BDklPICkZfSrNatQfif3P3XiIE1CrhR7J7TeXZIM4qd2JSeR7_1eh2xZsOhXne4o7KJcyMxUPqd_wY0c2sLMJ_b-ZkR9pFXB2PubE3d6n3OEdP4jNBOOHir6dETqzq21pdcUtDfZYopPu7Kmx2KsiQWMPeNMSGGaBfKMQqU3OohMUIR07sZ4yAmxLcIU0Dl6RqhwpLFuS_s","x-client-SKU":"ID_NETSTANDARD2_0","x-client-ver":"5.3.0.0"},"$type":"AuthorizeRequestValidationLog"}
2019-02-19 12:28:39.009 +01:00 [INF] Showing consent: User has not yet consented
2019-02-19 12:28:39.031 +01:00 [INF] Request finished in 1407.2245ms 302 
2019-02-19 12:28:39.035 +01:00 [INF] Request starting HTTP/1.1 GET http://localhost:44352/consent?returnUrl=%2Fconnect%2Fauthorize%2Fcallback%3Fclient_id%3Dhybridclient%26redirect_uri%3Dhttps%253A%252F%252Flocalhost%253A44329%252Fsignin-oidc%26response_type%3Dcode%2520id_token%26scope%3Dopenid%2520profile%2520scope_used_for_hybrid_flow%2520offline_access%26response_mode%3Dform_post%26nonce%3D636861725175898743.MzY4NTk2YzQtNjA5Yy00YjQ1LTk5ZWEtN2Y0ZGEwODE5NTc0N2IzNjBmYzUtNmZkMi00OGEzLWJkNTEtNGMwZDI0MmUxODgz%26state%3DCfDJ8CGpEylrt0pIt6txpyTWMbRWgv-c0Tzm-r1_wF11jqDzecyS1pscDzuprVBaSr5Du2f1V5i8LGaVakhwVbO0FHDeDOeNJdIU7fPHDWi89pPCF-SW4JxlObfsyNpuePKtMktU2a34Z9C0BDklPICkZfSrNatQfif3P3XiIE1CrhR7J7TeXZIM4qd2JSeR7_1eh2xZsOhXne4o7KJcyMxUPqd_wY0c2sLMJ_b-ZkR9pFXB2PubE3d6n3OEdP4jNBOOHir6dETqzq21pdcUtDfZYopPu7Kmx2KsiQWMPeNMSGGaBfKMQqU3OohMUIR07sZ4yAmxLcIU0Dl6RqhwpLFuS_s%26x-client-SKU%3DID_NETSTANDARD2_0%26x-client-ver%3D5.3.0.0  
2019-02-19 12:28:39.043 +01:00 [INF] Executing endpoint 'StsServerIdentity.Controllers.ConsentController.Index (StsServerIdentity)'
2019-02-19 12:28:39.063 +01:00 [INF] Route matched with {action = "Index", controller = "Consent"}. Executing action StsServerIdentity.Controllers.ConsentController.Index (StsServerIdentity)
2019-02-19 12:28:39.137 +01:00 [INF] Executing action method StsServerIdentity.Controllers.ConsentController.Index (StsServerIdentity) with arguments (["/connect/authorize/callback?client_id=hybridclient&redirect_uri=https%3A%2F%2Flocalhost%3A44329%2Fsignin-oidc&response_type=code%20id_token&scope=openid%20profile%20scope_used_for_hybrid_flow%20offline_access&response_mode=form_post&nonce=636861725175898743.MzY4NTk2YzQtNjA5Yy00YjQ1LTk5ZWEtN2Y0ZGEwODE5NTc0N2IzNjBmYzUtNmZkMi00OGEzLWJkNTEtNGMwZDI0MmUxODgz&state=CfDJ8CGpEylrt0pIt6txpyTWMbRWgv-c0Tzm-r1_wF11jqDzecyS1pscDzuprVBaSr5Du2f1V5i8LGaVakhwVbO0FHDeDOeNJdIU7fPHDWi89pPCF-SW4JxlObfsyNpuePKtMktU2a34Z9C0BDklPICkZfSrNatQfif3P3XiIE1CrhR7J7TeXZIM4qd2JSeR7_1eh2xZsOhXne4o7KJcyMxUPqd_wY0c2sLMJ_b-ZkR9pFXB2PubE3d6n3OEdP4jNBOOHir6dETqzq21pdcUtDfZYopPu7Kmx2KsiQWMPeNMSGGaBfKMQqU3OohMUIR07sZ4yAmxLcIU0Dl6RqhwpLFuS_s&x-client-SKU=ID_NETSTANDARD2_0&x-client-ver=5.3.0.0"]) - Validation state: "Valid"
2019-02-19 12:28:39.419 +01:00 [INF] Executed action method StsServerIdentity.Controllers.ConsentController.Index (StsServerIdentity), returned result Microsoft.AspNetCore.Mvc.ViewResult in 282.5433ms.
2019-02-19 12:28:39.422 +01:00 [INF] Executing ViewResult, running view Index.
2019-02-19 12:28:39.652 +01:00 [INF] Request starting HTTP/1.1 GET http://localhost:44352/.well-known/openid-configuration  
2019-02-19 12:28:39.653 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-02-19 12:28:39.653 +01:00 [INF] Request finished in 1.4467ms 200 application/json; charset=UTF-8
2019-02-19 12:28:39.678 +01:00 [INF] Executed ViewResult - view Index executed in 751.9206ms.
2019-02-19 12:28:39.679 +01:00 [INF] Executed action StsServerIdentity.Controllers.HomeController.Index (StsServerIdentity) in 859.4541ms
2019-02-19 12:28:39.679 +01:00 [INF] Executed endpoint 'StsServerIdentity.Controllers.HomeController.Index (StsServerIdentity)'
2019-02-19 12:28:39.683 +01:00 [INF] Request finished in 3827.794ms 200 text/html; charset=utf-8
2019-02-19 12:28:39.696 +01:00 [INF] Executed ViewResult - view Index executed in 276.2355ms.
2019-02-19 12:28:39.698 +01:00 [INF] Executed action StsServerIdentity.Controllers.ConsentController.Index (StsServerIdentity) in 634.485ms
2019-02-19 12:28:39.698 +01:00 [INF] Executed endpoint 'StsServerIdentity.Controllers.ConsentController.Index (StsServerIdentity)'
2019-02-19 12:28:39.698 +01:00 [INF] Request finished in 663.3756ms 200 text/html; charset=utf-8
2019-02-19 12:28:39.718 +01:00 [INF] Request starting HTTP/1.1 GET http://localhost:44352/css/vendor.min.css?v=RtIwopEx0osLqdXB1F1QPDFWzutpmmdukcoICaRWUFI  
2019-02-19 12:28:39.719 +01:00 [INF] Request starting HTTP/1.1 GET http://localhost:44352/css/site.min.css?v=9n42HB2zuqXKDsr8sMaXB5eFvO87SuAf1CjiV4cv1Fg  
2019-02-19 12:28:39.720 +01:00 [INF] Request starting HTTP/1.1 GET http://localhost:44352/js/vendor.min.js?v=yg3700ylkpEbw8o9sR1SsYLHNI0v7pw6lI42YH1q40o  
2019-02-19 12:28:39.724 +01:00 [INF] Request starting HTTP/1.1 GET http://localhost:44352/js/site.min.js?v=47DEQpj8HBSa-_TImW-5JCeuQeRkm5NMpJWZG3hSuFU  
2019-02-19 12:28:39.729 +01:00 [INF] Request starting HTTP/1.1 GET http://localhost:44352/.well-known/openid-configuration/jwks  
2019-02-19 12:28:39.730 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2019-02-19 12:28:39.731 +01:00 [INF] Request finished in 1.9287ms 200 application/jwk-set+json; charset=UTF-8
2019-02-19 12:28:39.743 +01:00 [INF] Sending file. Request path: '/js/site.min.js'. Physical path: 'C:\git\damienbod\AspNetCoreHybridFlowWithApi\StsServer\wwwroot\js\site.min.js'
2019-02-19 12:28:39.743 +01:00 [INF] Request finished in 19.4598ms 200 application/javascript
2019-02-19 12:28:39.744 +01:00 [INF] Sending file. Request path: '/css/site.min.css'. Physical path: 'C:\git\damienbod\AspNetCoreHybridFlowWithApi\StsServer\wwwroot\css\site.min.css'
2019-02-19 12:28:39.744 +01:00 [INF] Request finished in 25.0661ms 200 text/css
2019-02-19 12:28:39.781 +01:00 [INF] Sending file. Request path: '/js/vendor.min.js'. Physical path: 'C:\git\damienbod\AspNetCoreHybridFlowWithApi\StsServer\wwwroot\js\vendor.min.js'
2019-02-19 12:28:39.781 +01:00 [INF] Sending file. Request path: '/css/vendor.min.css'. Physical path: 'C:\git\damienbod\AspNetCoreHybridFlowWithApi\StsServer\wwwroot\css\vendor.min.css'
2019-02-19 12:28:39.781 +01:00 [INF] Request finished in 62.9817ms 200 text/css
2019-02-19 12:28:39.781 +01:00 [INF] Request finished in 61.3323ms 200 application/javascript
2019-02-19 12:28:39.922 +01:00 [INF] Request starting HTTP/1.1 POST http://localhost:44352/connect/deviceauthorization application/x-www-form-urlencoded 56
2019-02-19 12:28:39.927 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DeviceAuthorizationEndpoint for /connect/deviceauthorization
2019-02-19 12:28:40.014 +01:00 [INF] Request finished in 92.2734ms 200 application/json; charset=UTF-8
2019-02-19 12:28:45.745 +01:00 [INF] Request starting HTTP/1.1 GET http://localhost:44352/device  
2019-02-19 12:28:45.750 +01:00 [INF] Executing endpoint 'StsServerIdentity.Controllers.DeviceController.Index (StsServerIdentity)'
2019-02-19 12:28:45.758 +01:00 [INF] Route matched with {action = "Index", controller = "Device"}. Executing action StsServerIdentity.Controllers.DeviceController.Index (StsServerIdentity)
2019-02-19 12:28:45.774 +01:00 [INF] Authorization was successful.
2019-02-19 12:28:45.815 +01:00 [INF] Executing action method StsServerIdentity.Controllers.DeviceController.Index (StsServerIdentity) with arguments ([""]) - Validation state: "Valid"
2019-02-19 12:28:45.817 +01:00 [INF] Executed action method StsServerIdentity.Controllers.DeviceController.Index (StsServerIdentity), returned result Microsoft.AspNetCore.Mvc.ViewResult in 1.4593ms.
2019-02-19 12:28:45.823 +01:00 [INF] Executing ViewResult, running view UserCodeCapture.
2019-02-19 12:28:45.832 +01:00 [INF] Executed ViewResult - view UserCodeCapture executed in 15.5927ms.
2019-02-19 12:28:45.833 +01:00 [INF] Executed action StsServerIdentity.Controllers.DeviceController.Index (StsServerIdentity) in 74.0363ms
2019-02-19 12:28:45.833 +01:00 [INF] Executed endpoint 'StsServerIdentity.Controllers.DeviceController.Index (StsServerIdentity)'
2019-02-19 12:28:45.833 +01:00 [INF] Request finished in 87.8443ms 200 text/html; charset=utf-8
2019-02-19 12:28:46.027 +01:00 [INF] Request starting HTTP/1.1 GET http://localhost:44352/device  
2019-02-19 12:28:46.028 +01:00 [INF] Executing endpoint 'StsServerIdentity.Controllers.DeviceController.Index (StsServerIdentity)'
2019-02-19 12:28:46.028 +01:00 [INF] Route matched with {action = "Index", controller = "Device"}. Executing action StsServerIdentity.Controllers.DeviceController.Index (StsServerIdentity)
2019-02-19 12:28:46.029 +01:00 [INF] Authorization was successful.
2019-02-19 12:28:46.096 +01:00 [INF] Executing action method StsServerIdentity.Controllers.DeviceController.Index (StsServerIdentity) with arguments ([""]) - Validation state: "Valid"
2019-02-19 12:28:46.096 +01:00 [INF] Executed action method StsServerIdentity.Controllers.DeviceController.Index (StsServerIdentity), returned result Microsoft.AspNetCore.Mvc.ViewResult in 0.0877ms.
2019-02-19 12:28:46.097 +01:00 [INF] Executing ViewResult, running view UserCodeCapture.
2019-02-19 12:28:46.101 +01:00 [INF] Executed ViewResult - view UserCodeCapture executed in 4.1934000000000005ms.
2019-02-19 12:28:46.101 +01:00 [INF] Executed action StsServerIdentity.Controllers.DeviceController.Index (StsServerIdentity) in 72.730100000000007ms
2019-02-19 12:28:46.102 +01:00 [INF] Executed endpoint 'StsServerIdentity.Controllers.DeviceController.Index (StsServerIdentity)'
2019-02-19 12:28:46.102 +01:00 [INF] Request finished in 75.7299ms 200 text/html; charset=utf-8
2019-02-19 12:28:52.790 +01:00 [INF] Request starting HTTP/1.1 POST http://localhost:44352/Device/UserCodeCapture application/x-www-form-urlencoded 244
2019-02-19 12:28:52.804 +01:00 [INF] Executing endpoint 'StsServerIdentity.Controllers.DeviceController.UserCodeCapture (StsServerIdentity)'
2019-02-19 12:28:52.811 +01:00 [INF] Route matched with {action = "UserCodeCapture", controller = "Device"}. Executing action StsServerIdentity.Controllers.DeviceController.UserCodeCapture (StsServerIdentity)
2019-02-19 12:28:52.811 +01:00 [INF] Authorization was successful.
2019-02-19 12:28:52.855 +01:00 [INF] Executing action method StsServerIdentity.Controllers.DeviceController.UserCodeCapture (StsServerIdentity) with arguments (["263825636"]) - Validation state: "Valid"
2019-02-19 12:28:52.862 +01:00 [INF] Executed action method StsServerIdentity.Controllers.DeviceController.UserCodeCapture (StsServerIdentity), returned result Microsoft.AspNetCore.Mvc.ViewResult in 7.5835000000000008ms.
2019-02-19 12:28:52.865 +01:00 [INF] Executing ViewResult, running view UserCodeConfirmation.
2019-02-19 12:28:52.884 +01:00 [INF] Executed ViewResult - view UserCodeConfirmation executed in 21.0826ms.
2019-02-19 12:28:52.884 +01:00 [INF] Executed action StsServerIdentity.Controllers.DeviceController.UserCodeCapture (StsServerIdentity) in 73.0545ms
2019-02-19 12:28:52.884 +01:00 [INF] Executed endpoint 'StsServerIdentity.Controllers.DeviceController.UserCodeCapture (StsServerIdentity)'
2019-02-19 12:28:52.884 +01:00 [INF] Request finished in 93.5194ms 200 text/html; charset=utf-8
2019-02-19 12:28:52.898 +01:00 [INF] Request starting HTTP/1.1 GET http://localhost:44352/css/site.min.css?v=9n42HB2zuqXKDsr8sMaXB5eFvO87SuAf1CjiV4cv1Fg  
2019-02-19 12:28:52.899 +01:00 [INF] The file /css/site.min.css was not modified
2019-02-19 12:28:52.900 +01:00 [INF] Request starting HTTP/1.1 GET http://localhost:44352/css/vendor.min.css?v=RtIwopEx0osLqdXB1F1QPDFWzutpmmdukcoICaRWUFI  
2019-02-19 12:28:52.903 +01:00 [INF] Request finished in 1.9069ms 304 text/css
2019-02-19 12:28:52.903 +01:00 [INF] The file /css/vendor.min.css was not modified
2019-02-19 12:28:52.903 +01:00 [INF] Request finished in 2.9401ms 304 text/css
2019-02-19 12:28:52.907 +01:00 [INF] Request starting HTTP/1.1 GET http://localhost:44352/js/site.min.js?v=47DEQpj8HBSa-_TImW-5JCeuQeRkm5NMpJWZG3hSuFU  
2019-02-19 12:28:52.907 +01:00 [INF] Request starting HTTP/1.1 GET http://localhost:44352/js/vendor.min.js?v=yg3700ylkpEbw8o9sR1SsYLHNI0v7pw6lI42YH1q40o  
2019-02-19 12:28:52.908 +01:00 [INF] The file /js/vendor.min.js was not modified
2019-02-19 12:28:52.909 +01:00 [INF] Request finished in 1.1122ms 304 application/javascript
2019-02-19 12:28:52.910 +01:00 [INF] The file /js/site.min.js was not modified
2019-02-19 12:28:52.911 +01:00 [INF] Request finished in 3.3929ms 304 application/javascript
2019-02-19 12:28:54.031 +01:00 [INF] Request starting HTTP/1.1 POST http://localhost:44352/Device/Callback application/x-www-form-urlencoded 367
2019-02-19 12:28:54.043 +01:00 [INF] Executing endpoint 'StsServerIdentity.Controllers.DeviceController.Callback (StsServerIdentity)'
2019-02-19 12:28:54.083 +01:00 [INF] Route matched with {action = "Callback", controller = "Device"}. Executing action StsServerIdentity.Controllers.DeviceController.Callback (StsServerIdentity)
2019-02-19 12:28:54.083 +01:00 [INF] Authorization was successful.
2019-02-19 12:28:54.141 +01:00 [INF] Executing action method StsServerIdentity.Controllers.DeviceController.Callback (StsServerIdentity) with arguments (["StsServerIdentity.Models.DeviceAuthorizationInputModel"]) - Validation state: "Valid"
2019-02-19 12:28:54.151 +01:00 [INF] Executed action method StsServerIdentity.Controllers.DeviceController.Callback (StsServerIdentity), returned result Microsoft.AspNetCore.Mvc.ViewResult in 9.8462ms.
2019-02-19 12:28:54.156 +01:00 [INF] Executing ViewResult, running view Success.
2019-02-19 12:28:54.160 +01:00 [INF] Executed ViewResult - view Success executed in 9.1772000000000009ms.
2019-02-19 12:28:54.160 +01:00 [INF] Executed action StsServerIdentity.Controllers.DeviceController.Callback (StsServerIdentity) in 77.0879ms
2019-02-19 12:28:54.160 +01:00 [INF] Executed endpoint 'StsServerIdentity.Controllers.DeviceController.Callback (StsServerIdentity)'
2019-02-19 12:28:54.160 +01:00 [INF] Request finished in 129.356ms 200 text/html; charset=utf-8
2019-02-19 12:28:56.575 +01:00 [INF] Request starting HTTP/1.1 GET http://localhost:44352/.well-known/openid-configuration  
2019-02-19 12:28:56.576 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-02-19 12:28:56.577 +01:00 [INF] Request finished in 1.3221ms 200 application/json; charset=UTF-8
2019-02-19 12:28:56.579 +01:00 [INF] Request starting HTTP/1.1 GET http://localhost:44352/.well-known/openid-configuration/jwks  
2019-02-19 12:28:56.579 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2019-02-19 12:28:56.580 +01:00 [INF] Request finished in 0.8993ms 200 application/jwk-set+json; charset=UTF-8
2019-02-19 12:28:56.613 +01:00 [INF] Request starting HTTP/1.1 POST http://localhost:44352/connect/token application/x-www-form-urlencoded 172
2019-02-19 12:28:56.617 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.TokenEndpoint for /connect/token
2019-02-19 12:28:56.655 +01:00 [INF] Entity Framework Core 2.2.2-servicing-10034 initialized 'ApplicationDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer' with options: None
2019-02-19 12:28:56.699 +01:00 [INF] Executed DbCommand (42ms) [Parameters=[@__get_Item_0='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [e].[Id], [e].[AccessFailedCount], [e].[ConcurrencyStamp], [e].[DataEventRecordsRole], [e].[Email], [e].[EmailConfirmed], [e].[IsAdmin], [e].[LockoutEnabled], [e].[LockoutEnd], [e].[NormalizedEmail], [e].[NormalizedUserName], [e].[PasswordHash], [e].[PhoneNumber], [e].[PhoneNumberConfirmed], [e].[SecuredFilesRole], [e].[SecurityStamp], [e].[TwoFactorEnabled], [e].[UserName]
FROM [AspNetUsers] AS [e]
WHERE [e].[Id] = @__get_Item_0
2019-02-19 12:28:56.710 +01:00 [INF] Token request validation success
{"ClientId":"deviceFlowWebClient","ClientName":"Device Flow Client","GrantType":"urn:ietf:params:oauth:grant-type:device_code","Scopes":null,"AuthorizationCode":null,"RefreshToken":null,"UserName":null,"AuthenticationContextReferenceClasses":null,"Tenant":null,"IdP":null,"Raw":{"device_code":"***REDACTED***","grant_type":"urn:ietf:params:oauth:grant-type:device_code","client_id":"deviceFlowWebClient"},"$type":"TokenRequestValidationLog"}
2019-02-19 12:28:56.768 +01:00 [INF] Executed DbCommand (28ms) [Parameters=[@__user_Id_0='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT [uc].[Id], [uc].[ClaimType], [uc].[ClaimValue], [uc].[UserId]
FROM [AspNetUserClaims] AS [uc]
WHERE [uc].[UserId] = @__user_Id_0
2019-02-19 12:28:56.798 +01:00 [INF] Executed DbCommand (29ms) [Parameters=[@__userId_0='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT [role].[Name]
FROM [AspNetUserRoles] AS [userRole]
INNER JOIN [AspNetRoles] AS [role] ON [userRole].[RoleId] = [role].[Id]
WHERE [userRole].[UserId] = @__userId_0
2019-02-19 12:28:56.902 +01:00 [INF] Executed DbCommand (36ms) [Parameters=[@__user_Id_0='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT [uc].[Id], [uc].[ClaimType], [uc].[ClaimValue], [uc].[UserId]
FROM [AspNetUserClaims] AS [uc]
WHERE [uc].[UserId] = @__user_Id_0
2019-02-19 12:28:56.929 +01:00 [INF] Executed DbCommand (26ms) [Parameters=[@__userId_0='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT [role].[Name]
FROM [AspNetUserRoles] AS [userRole]
INNER JOIN [AspNetRoles] AS [role] ON [userRole].[RoleId] = [role].[Id]
WHERE [userRole].[UserId] = @__userId_0
2019-02-19 12:28:56.947 +01:00 [INF] Request finished in 333.5217ms 200 application/json; charset=UTF-8
